<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="&#34;auto&#34;"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png"><link rel="icon" href="/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#2f4154"><meta name="description" content="梦里的竹蜻蜓 一个写bug的程序员"><meta name="author" content="Fool"><meta name="keywords" content="Hexo,JavaScript,html5,css3,Jquery,NodeJs,github,css,js,html,java,blog,博客"><meta name="baidu-site-verification" content="code-yIv1xTa1ed"><meta name="google-site-verification" content="1zwyY4tiPsHyxK1HeGG9l5f7srBaAW3y7T6oyfo-7Vk"><title>Optional (一个为了 Null 元素和Lambda设计的类) - 梦里的竹蜻蜓</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css"><link rel="stylesheet" href="/lib/hint/hint.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><script id="fluid-configs">var Fluid=window.Fluid||{},CONFIG={hostname:"blog.guard.ren",root:"/",version:"1.8.11",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},copy_btn:!0,image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:1},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,baidu:"2d6a21bdd6e9c407e7e8a37193a8230b",google:"ga:192080150",gtag:"UA-136832726-1",tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:"XhzUk14bCmCVREHE5ROg559J-MdYXbMMI",app_key:"c8Fw7RQke0iYCjQb2NX4jwSW",server_url:null}},search_path:"/local-search.xml"}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>梦里的竹蜻蜓</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 时间轴</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 简介</a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> 链接</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner" id="banner" parallax="true" style="background:url(/img/default_post.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="page-header text-center fade-in-up"><span class="h2" id="subtitle" title="Optional (一个为了 Null 元素和Lambda设计的类)"></span><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2021-07-26 20:59" pubdate>2021-07-26 20:59</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 3.5k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 69 分钟 </span><span id="leancloud-page-views-container" class="post-meta" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="leancloud-page-views"></span> 次</span></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto"><h1 style="display:none">Optional (一个为了 Null 元素和Lambda设计的类)</h1><p class="note note-info">本文最后更新于：2021-08-15 18:07</p><div class="markdown-body"><h1 id="Optional-描述"><a href="#Optional-描述" class="headerlink" title="Optional 描述"></a>Optional 描述</h1><p>然我们先来瞅瞅这个类的描述，他到底干什么的</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">可能包含也可能不包含非空值的容器对象。<br><br>如果存在值， isPresent()将返回<span class="hljs-literal">true</span> ， get()将返回该值。<br><br>提供了依赖于包含值的存在与否的其他方法，<br>例如orElse() （如果值不存在则返回默认值）和ifPresent() （如果值存在则执行代码块）。<br><br>这是一个基于值的类；<br>在Optional实例上使用身份敏感操作（包括引用相等性 ( == )、身份哈希码或同步）可能会产生不可预测的结果，应该避免。<br></code></pre></div></td></tr></table></figure><p>这个类还是比较简单易懂的，差不多看一遍经常用就能熟悉了，当然这上面说的这么多，个人看来就是 null 的抽象类<br><img src="https://cdn.nlark.com/yuque/0/2021/png/241578/1627310958615-2900fec1-3416-4b23-809c-09425fa57581.png#align=left&display=inline&height=769&margin=%5Bobject%20Object%5D&name=image.png&originHeight=769&originWidth=850&size=95368&status=done&style=none&width=850" srcset="/img/loading.gif" lazyload alt="image.png"></p><h1 id="初始化对象"><a href="#初始化对象" class="headerlink" title="初始化对象"></a>初始化对象</h1><p>可以通过上面结构看到它其实有两个构造器但都是私有的，这么说来就不能用<code>new</code>的方式来初始化</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">    * empty()常见实例。</span><br><span class="hljs-comment">    */</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Optional&lt;?&gt; EMPTY = <span class="hljs-keyword">new</span> Optional&lt;&gt;();<br><br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * 如果非空，则该值； 如果为空，则表示不存在值</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> T value;<br><br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * 构造一个空实例。</span><br><span class="hljs-comment"> * 实现说明：</span><br><span class="hljs-comment"> * 通常，每个 VM 应该只存在一个空实例EMPTY 。</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Optional</span><span class="hljs-params">()</span> </span>&#123;<br>       <span class="hljs-keyword">this</span>.value = <span class="hljs-keyword">null</span>;<br>   &#125;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment">    * 构造一个具有当前值的实例。</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> value – 要存在的非空值</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> NullPointerException – 如果值为 null</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Optional</span><span class="hljs-params">(T value)</span> </span>&#123;<br>       <span class="hljs-comment">// Objects.requireNonNull 检测是否为null 如果为null 会直接抛出异常 NullPointerException()</span><br>       <span class="hljs-keyword">this</span>.value = Objects.requireNonNull(value);<br>   &#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">    * 返回一个空的Optional实例。 此 Optional 不存在任何值。</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@apiNote</span> 尽管这样做可能很诱人，但避免通过将==与Option.empty()返回的实例进行比较来测试对象是否为空。</span><br><span class="hljs-comment">    * 不能保证它是单例。 相反，使用isPresent() 。</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> &lt;T&gt; - 不存在值的类型</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@return</span> 空的Optional</span><br><span class="hljs-comment">    */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span>&lt;T&gt; Optional&lt;T&gt; <span class="hljs-title">empty</span><span class="hljs-params">()</span> </span>&#123;<br>       <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>       Optional&lt;T&gt; t = (Optional&lt;T&gt;) EMPTY;<br>       <span class="hljs-keyword">return</span> t;<br>   &#125;<br></code></pre></div></td></tr></table></figure><p>上面这个是类里面私有的东西，留个印象<br>其实在类里面有两个地方使用了<code>new Optional&lt;&gt;</code> ，这两个地方也就是初始化对象的关键，当然还有一个直接创造了一个空的实例，但不建议这么做</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">    * empty()常见实例。</span><br><span class="hljs-comment">    */</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Optional&lt;?&gt; EMPTY = <span class="hljs-keyword">new</span> Optional&lt;&gt;();<br><span class="hljs-comment">/**</span><br><span class="hljs-comment">    * 返回具有指定当前非空值的Optional 。</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> value – 要存在的值，必须为非空类型参数：&lt;T&gt; - 值的类别</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@return</span> 一个Optional的值存在</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@throws</span> NullPointerException – 如果值为 null</span><br><span class="hljs-comment">    */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">Optional&lt;T&gt; <span class="hljs-title">of</span><span class="hljs-params">(T value)</span> </span>&#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Optional&lt;&gt;(value);<br>   &#125;<br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * 返回一个描述指定值的Optional ，如果非空，否则返回一个空的Optional 。</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> value – 要存在的值，必须为非空类型参数：&lt;T&gt; - 值的类别</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@return</span> 如果指定的值为非空，则为具有当前值的Optional ，否则为空Optional</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">Optional&lt;T&gt; <span class="hljs-title">ofNullable</span><span class="hljs-params">(T value)</span> </span>&#123;<br>       <span class="hljs-keyword">return</span> value == <span class="hljs-keyword">null</span> ? empty() : of(value);<br>   &#125;<br></code></pre></div></td></tr></table></figure><p>因为第一个<code>new Optional&lt;&gt;</code>是私有化的我们在外部无法访问，那么我们现在就只有两个方式可以去实例化对象，而这个的差别就在判空。</p><p>我们关联上面和下面给出的代码</p><ul><li><code>of</code>方法当我们传入<code>null</code>对象的时候，它调用构造方法的时候会去检验当前对象是否为空，那么必定会抛出异常</li><li><code>ofNullable</code>方法会直接判断是否传入为 null，如果为<code>null</code>调用<code>empty()</code>，不为空那么调用<code>of</code>方法</li></ul><p>那我们就来看看<code>empty()</code>这个方法</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * 返回一个空的Optional实例。 此 Optional 不存在任何值。</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@apiNote</span> 尽管这样做可能很诱人，</span><br><span class="hljs-comment">    * 但避免通过将==与Option.empty()返回的实例进行比较来测试对象是否为空。</span><br><span class="hljs-comment">    * 不能保证它是单例。 相反，使用isPresent() 。</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> &lt;T&gt; - 不存在值的类型</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@return</span> 空的Optional</span><br><span class="hljs-comment">    */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span>&lt;T&gt; Optional&lt;T&gt; <span class="hljs-title">empty</span><span class="hljs-params">()</span> </span>&#123;<br>       <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>       Optional&lt;T&gt; t = (Optional&lt;T&gt;) EMPTY;<br>       <span class="hljs-keyword">return</span> t;<br>   &#125;<br></code></pre></div></td></tr></table></figure><p>这个确实干了一件很简单的事，强制使用<code>EMPTY</code>，从而避免<code>null</code>。</p><h2 id="如："><a href="#如：" class="headerlink" title="如："></a>如：</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test1</span><span class="hljs-params">()</span> </span>&#123;<br>    Optional&lt;String&gt; string1 = Optional.of(<span class="hljs-string">&quot;这是一个String&quot;</span>);<br>    <span class="hljs-comment">//Optional&lt;String&gt; strNull1 = Optional.of(null); java.lang.NullPointerException</span><br>    Optional&lt;String&gt; string2 = Optional.ofNullable(<span class="hljs-string">&quot;这是另一个String&quot;</span>);<br>    Optional&lt;String&gt; strNull2 = Optional.ofNullable(<span class="hljs-keyword">null</span>);<br>    Optional.empty();<br>&#125;<br></code></pre></div></td></tr></table></figure><h1 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h1><h2 id="get"><a href="#get" class="headerlink" title="get"></a>get</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * 如果此Optional存在值，则返回该值，否则抛出NoSuchElementException 。</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@return</span> 此Optional持有的非空值</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@throws</span> NoSuchElementException – 如果没有值存在</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@see</span> Optional#isPresent()</span><br><span class="hljs-comment">    */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> T <span class="hljs-title">get</span><span class="hljs-params">()</span> </span>&#123;<br>       <span class="hljs-keyword">if</span> (value == <span class="hljs-keyword">null</span>) &#123;<br>           <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NoSuchElementException(<span class="hljs-string">&quot;No value present&quot;</span>);<br>       &#125;<br>       <span class="hljs-keyword">return</span> value;<br>   &#125;<br></code></pre></div></td></tr></table></figure><p>这个方法很简单了就是获取 value 的值。</p><h3 id="如"><a href="#如" class="headerlink" title="如:"></a>如:</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test2</span><span class="hljs-params">()</span> </span>&#123;<br>    System.out.println(Optional.of(<span class="hljs-string">&quot;这是一个String&quot;</span>).get());<br>    <span class="hljs-comment">//这是一个String</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="isPresent"><a href="#isPresent" class="headerlink" title="isPresent"></a>isPresent</h2><p>这是两个方法</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 如果存在值则返回true ，否则返回false 。</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> 如果存在值则为true ，否则为false</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isPresent</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> value != <span class="hljs-keyword">null</span>;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><p>用于判断当前对象存不存在值，也就是 value 是不是为空</p><h3 id="如：-1"><a href="#如：-1" class="headerlink" title="如："></a>如：</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test3</span><span class="hljs-params">()</span> </span>&#123;<br>    Optional&lt;String&gt; string1 = Optional.of(<span class="hljs-string">&quot;这是一个String&quot;</span>);<br>    System.out.println(string1.isPresent());<br>    <span class="hljs-comment">//true</span><br>    Optional&lt;String&gt; strNull2 = Optional.ofNullable(<span class="hljs-keyword">null</span>);<br>    System.out.println(strNull2.isPresent());<br>    <span class="hljs-comment">//false</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="ifPresent"><a href="#ifPresent" class="headerlink" title="ifPresent"></a>ifPresent</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 如果存在值，则使用该值调用指定的使用者，否则不执行任何操作。</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> 消费者 – 如果存在值则执行块</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> NullPointerException – 如果值存在且consumer为空</span><br><span class="hljs-comment"> * null</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ifPresent</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-keyword">super</span> T&gt; consumer)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (value != <span class="hljs-keyword">null</span>)<br>        consumer.accept(value);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>这个方法和上一个判断差不多，但是提供了一个函数式接口，可以直接操作其中的对象<br>这个方法支持传入<code>null</code>但是不会做任何操作</p><h3 id="如：-2"><a href="#如：-2" class="headerlink" title="如："></a>如：</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test4</span><span class="hljs-params">()</span> </span>&#123;<br>    Optional&lt;String&gt; string1 = Optional.of(<span class="hljs-string">&quot;这是一个String&quot;</span>);<br>    string1.ifPresent(System.out::println);<br>    <span class="hljs-comment">//这是一个String</span><br>    Optional&lt;String&gt; strNull2 = Optional.ofNullable(<span class="hljs-keyword">null</span>);<br>    strNull2.ifPresent(System.out::println);<br>    <span class="hljs-comment">//</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * 如果存在一个值，并且该值与给定的谓词匹配，</span><br><span class="hljs-comment">    * 则返回一个描述该值的Optional ，否则返回一个空的Optional 。</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> predicate – 应用于值的谓词（如果存在）</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@return</span> 一个Optional描述此的值Optional一个值是否存在，</span><br><span class="hljs-comment">    * 并且值给定的谓词相匹配，否则一个空Optional</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@throws</span> NullPointerException – 如果谓词为空</span><br><span class="hljs-comment">    */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Optional&lt;T&gt; <span class="hljs-title">filter</span><span class="hljs-params">(Predicate&lt;? <span class="hljs-keyword">super</span> T&gt; predicate)</span> </span>&#123;<br>       Objects.requireNonNull(predicate);<br>       <span class="hljs-keyword">if</span> (!isPresent())<br>           <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<br>       <span class="hljs-keyword">else</span><br>           <span class="hljs-keyword">return</span> predicate.test(value) ? <span class="hljs-keyword">this</span> : empty();<br>   &#125;<br></code></pre></div></td></tr></table></figure><p>这个是一个用于筛选数据的方法，提供了一个函数接口返回<code>boolean</code>，这里里面的筛选机制很有趣</p><ul><li>当前对象为<code>null</code>的时候直接返回当前对象</li><li>当前对象不为<code>null</code>的时候，运行接口方法，并且当条件不满足的时候还会返回一个空的对象类，只不过不存在<code>value</code></li></ul><h3 id="如：-3"><a href="#如：-3" class="headerlink" title="如："></a>如：</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test5</span><span class="hljs-params">()</span> </span>&#123;<br>    Optional&lt;String&gt; strNull2 = Optional.ofNullable(<span class="hljs-keyword">null</span>);<br>    System.out.println(strNull2.filter(x -&gt; x.length() &gt; <span class="hljs-number">6</span>).isPresent());<br>    <span class="hljs-comment">//false</span><br>    Optional&lt;String&gt; string1 = Optional.of(<span class="hljs-string">&quot;这是一个String&quot;</span>);<br>    System.out.println(string1.filter(x -&gt; x.length() &gt; <span class="hljs-number">6</span>).isPresent());<br>    <span class="hljs-comment">//true</span><br>    List&lt;Optional&lt;Integer&gt;&gt; collect = <span class="hljs-keyword">new</span> Random().ints(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>).limit(<span class="hljs-number">100</span>).boxed().collect(() -&gt; &#123;<br>        List&lt;Optional&lt;Integer&gt;&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        list.add(Optional.of(-<span class="hljs-number">1</span>));<br>        <span class="hljs-keyword">return</span> list;<br>    &#125;, (lastList, value) -&gt; &#123;<br>        lastList.add(Optional.of(value));<br>    &#125;, List::addAll);<br>    collect.forEach(x -&gt; &#123;<br>        <span class="hljs-keyword">if</span> (x.isPresent()) &#123;<br>            x.filter(y -&gt; y &gt; <span class="hljs-number">50</span>).ifPresent(y-&gt; System.out.print(y+<span class="hljs-string">&quot;\t&quot;</span>));<br>        &#125;<br>    &#125;);<br><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="map"><a href="#map" class="headerlink" title="map"></a>map</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">    * 如果存在值，则对其应用提供的映射函数，如果结果非空，则返回描述结果的Optional 。</span><br><span class="hljs-comment">    * 否则返回一个空的Optional 。</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@apiNote</span></span><br><span class="hljs-comment">    * 此方法支持对可选值进行后处理，而无需显式检查返回状态。</span><br><span class="hljs-comment">    * 例如，以下代码遍历文件名流，选择尚未处理的文件名，然后打开该文件，返回Optional&lt;FileInputStream&gt; ：</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * Optional&lt;FileInputStream&gt; fis =</span><br><span class="hljs-comment">    *    names.stream().filter(name -&gt; !isProcessedYet(name))</span><br><span class="hljs-comment">    *                  .findFirst()</span><br><span class="hljs-comment">    *                  .map(name -&gt; new FileInputStream(name));</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * 在这里， findFirst返回一个Optional&lt;String&gt; ，然后map返回一个Optional&lt;FileInputStream&gt;所需的文件（如果存在）。</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> &lt;U&gt; - 映射函数的结果类型</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> mapper – 应用于值的映射函数（如果存在）</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@return</span> 一个Optional描述应用映射函数此的值的结果Optional ，</span><br><span class="hljs-comment">    * 如果一个值存在，否则一个空Optional</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@throws</span> NullPointerException – 如果映射函数为空</span><br><span class="hljs-comment">    */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span>&lt;U&gt; Optional&lt;U&gt; <span class="hljs-title">map</span><span class="hljs-params">(Function&lt;? <span class="hljs-keyword">super</span> T, ? extends U&gt; mapper)</span> </span>&#123;<br>       Objects.requireNonNull(mapper);<br>       <span class="hljs-keyword">if</span> (!isPresent())<br>           <span class="hljs-keyword">return</span> empty();<br>       <span class="hljs-keyword">else</span> &#123;<br>           <span class="hljs-keyword">return</span> Optional.ofNullable(mapper.apply(value));<br>       &#125;<br>   &#125;<br></code></pre></div></td></tr></table></figure><p><code>map</code>和上面<code>filter</code>差不多但是对返回又有少许差别</p><ul><li>当前对象为<code>null</code>返回<code>value</code>为<code>null</code>的对象</li><li>当前对象不为<code>null</code>时，函数接口运行后的结果包裹一层<code>Optional</code>而且使用的是<code>ofNullable</code>避免返回为<code>null</code>时直接报错</li></ul><h3 id="如：-4"><a href="#如：-4" class="headerlink" title="如："></a>如：</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test6</span><span class="hljs-params">()</span> </span>&#123;<br>    Optional&lt;String&gt; strNull2 = Optional.ofNullable(<span class="hljs-keyword">null</span>);<br>    System.out.println(strNull2.map(String::length).isPresent());<br>    <span class="hljs-comment">//false</span><br>    Optional&lt;String&gt; string1 = Optional.of(<span class="hljs-string">&quot;这是一个String&quot;</span>);<br>    string1.map(String::length).ifPresent(System.out::println);<br>    <span class="hljs-comment">//10</span><br>    System.out.println(string1.filter(x -&gt; <span class="hljs-keyword">false</span>).map(String::length).isPresent());<br>    <span class="hljs-comment">//false</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="flatMap"><a href="#flatMap" class="headerlink" title="flatMap"></a>flatMap</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"> 	<span class="hljs-comment">/**</span><br><span class="hljs-comment">    * 如果存在一个值，则将提供的Optional承载映射函数应用于它，返回该结果，否则返回一个空的Optional 。</span><br><span class="hljs-comment">    * 此方法类似于map(Function) ，但提供的映射器的结果已经是Optional ，并且如果调用， flatMap不会用额外的Optional包装它。</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> &lt;U&gt; - Optional返回的类型参数</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> mapper – 应用于值的映射函数，如果存在映射函数</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@return</span> 将此Optional的值应用Optional承载映射函数的结果，如果存在值，否则为空Optional</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@throws</span> NullPointerException – 如果映射函数为空或返回空结果</span><br><span class="hljs-comment">    */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span>&lt;U&gt; Optional&lt;U&gt; <span class="hljs-title">flatMap</span><span class="hljs-params">(Function&lt;? <span class="hljs-keyword">super</span> T, Optional&lt;U&gt;&gt; mapper)</span> </span>&#123;<br>       Objects.requireNonNull(mapper);<br>       <span class="hljs-keyword">if</span> (!isPresent())<br>           <span class="hljs-keyword">return</span> empty();<br>       <span class="hljs-keyword">else</span> &#123;<br>           <span class="hljs-keyword">return</span> Objects.requireNonNull(mapper.apply(value));<br>       &#125;<br>   &#125;<br></code></pre></div></td></tr></table></figure><p>这个和<code>map</code>方法差不多，只不过里面存在一个<code>null</code>判断，当函数式接口返回的值是空，那么会直接抛出异常</p><h3 id="如：-5"><a href="#如：-5" class="headerlink" title="如："></a>如：</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test7</span><span class="hljs-params">()</span> </span>&#123;<br>    Optional&lt;String&gt; strNull2 = Optional.ofNullable(<span class="hljs-keyword">null</span>);<br>    System.out.println(strNull2.flatMap(x-&gt; Optional.ofNullable(x.toLowerCase())).isPresent());<br>    <span class="hljs-comment">//false</span><br>    Optional&lt;String&gt; string1 = Optional.of(<span class="hljs-string">&quot;这是一个String&quot;</span>);<br>    string1.flatMap(x-&gt; Optional.of(x.toUpperCase())).ifPresent(System.out::println);<br>    <span class="hljs-comment">//这是一个STRING</span><br>    System.out.println(string1.filter(x -&gt; <span class="hljs-keyword">false</span>).flatMap(x-&gt; Optional.ofNullable(x.toLowerCase())).isPresent());<br>    <span class="hljs-comment">//false</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="orElse"><a href="#orElse" class="headerlink" title="orElse"></a>orElse</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * 如果存在则返回值，否则返回other 。</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> 其他 - 如果没有值，则返回值，可能为空</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@return</span> 值（如果存在），否则为other</span><br><span class="hljs-comment">    */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> T <span class="hljs-title">orElse</span><span class="hljs-params">(T other)</span> </span>&#123;<br>       <span class="hljs-keyword">return</span> value != <span class="hljs-keyword">null</span> ? value : other;<br>   &#125;<br></code></pre></div></td></tr></table></figure><p>有一个很标准的三元运算符，这个没什么好说的</p><h3 id="如：-6"><a href="#如：-6" class="headerlink" title="如："></a>如：</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test8</span><span class="hljs-params">()</span> </span>&#123;<br>    Optional&lt;String&gt; strNull2 = Optional.ofNullable(<span class="hljs-keyword">null</span>);<br>    System.out.println(strNull2.orElse(<span class="hljs-string">&quot;这是一个null&quot;</span>));<br>    <span class="hljs-comment">//这是一个null</span><br>    Optional&lt;String&gt; string1 = Optional.of(<span class="hljs-string">&quot;这是一个String&quot;</span>);<br>    System.out.println(string1.orElse(<span class="hljs-string">&quot;这不是一个null&quot;</span>));<br>    <span class="hljs-comment">//这是一个String</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="orElseGet"><a href="#orElseGet" class="headerlink" title="orElseGet"></a>orElseGet</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 返回值（如果存在），否则调用other并返回该调用的结果。</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> 其他 - 如果没有值则返回结果的Supplier</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> 值（如果存在）否则other.get()的结果</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> NullPointerException – 如果值不存在且other为空</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> T <span class="hljs-title">orElseGet</span><span class="hljs-params">(Supplier&lt;? extends T&gt; other)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> value != <span class="hljs-keyword">null</span> ? value : other.get();<br>&#125;<br></code></pre></div></td></tr></table></figure><p>这个其实也差不多就是可以在最后使用一个<code>Supplier</code>来收个尾巴</p><h3 id="如：-7"><a href="#如：-7" class="headerlink" title="如："></a>如：</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test9</span><span class="hljs-params">()</span> </span>&#123;<br>    Optional&lt;String&gt; strNull2 = Optional.ofNullable(<span class="hljs-keyword">null</span>);<br>    System.out.println(strNull2.orElseGet(()-&gt;<span class="hljs-string">&quot;这是一个null&quot;</span>));<br>    <span class="hljs-comment">//这是一个null</span><br>    Optional&lt;String&gt; string1 = Optional.of(<span class="hljs-string">&quot;这是一个String&quot;</span>);<br>    System.out.println(string1.orElseGet(()-&gt;<span class="hljs-string">&quot;这不是一个null&quot;</span>));<br>    <span class="hljs-comment">//这是一个String</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="orElseThrow"><a href="#orElseThrow" class="headerlink" title="orElseThrow"></a>orElseThrow</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 返回包含的值（如果存在），否则抛出由提供的供应商创建的异常。</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@apiNote</span> 对带有空参数列表的异常构造函数的方法引用可以用作提供者。 例如， IllegalStateException::new</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &lt;X&gt; - 要抛出的异常类型</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> exceptionSupplier – 将返回要抛出的异常的供应商</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> 现值</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> X – 如果没有值存在</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> NullPointerException – 如果不存在任何值且exceptionSupplier为 null</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> &lt;X extends Throwable&gt; <span class="hljs-function">T <span class="hljs-title">orElseThrow</span><span class="hljs-params">(Supplier&lt;? extends X&gt; exceptionSupplier)</span> <span class="hljs-keyword">throws</span> X </span>&#123;<br>    <span class="hljs-keyword">if</span> (value != <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> value;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">throw</span> exceptionSupplier.get();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>这个就比较常用了直接抛出异常，当然推荐自定义异常后抛出，毕竟这是业务异常</p><h3 id="如：-8"><a href="#如：-8" class="headerlink" title="如："></a>如：</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test10</span><span class="hljs-params">()</span> </span>&#123;<br>    Optional&lt;String&gt; string1 = Optional.of(<span class="hljs-string">&quot;这是一个String&quot;</span>);<br>    System.out.println(string1.orElseThrow(()-&gt; <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">&quot;这个异常出去&quot;</span>)));<br>    <span class="hljs-comment">//这是一个String</span><br>    Optional&lt;String&gt; strNull2 = Optional.ofNullable(<span class="hljs-keyword">null</span>);<br>    System.out.println(strNull2.orElseThrow(RuntimeException::<span class="hljs-keyword">new</span>));<br>    <span class="hljs-comment">//java.lang.RuntimeException</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="equals-hashCode-toString"><a href="#equals-hashCode-toString" class="headerlink" title="equals/hashCode/toString"></a>equals/hashCode/toString</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 指示其他某个对象是否“等于”此 Optional。 在以下情况下，另一个对象被视为相等：</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * - 它也是一个Optional和；</span><br><span class="hljs-comment"> * - 两个实例都没有价值存在或；</span><br><span class="hljs-comment"> * - 当前值通过equals()彼此“相等”。</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> obj – 要测试是否相等的对象</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &#123;code true&#125; 如果另一个对象“等于”这个对象，否则为false</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">equals</span><span class="hljs-params">(Object obj)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> == obj) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (!(obj <span class="hljs-keyword">instanceof</span> Optional)) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br><br>    Optional&lt;?&gt; other = (Optional&lt;?&gt;) obj;<br>    <span class="hljs-keyword">return</span> Objects.equals(value, other.value);<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 返回当前值的哈希码值（如果有），如果没有值则返回 0（零）。</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> 当前值的哈希码值，如果不存在值则为 0</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hashCode</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> Objects.hashCode(value);<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 返回适合调试的此 Optional 的非空字符串表示形式。 确切的表示格式未指定，可能因实现和版本而异。</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@implSpec</span> 如果存在值，则结果必须在结果中包含其字符串表示。 Empty 和present Optionals 必须可以明确区分。</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> 此实例的字符串表示形式</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> value != <span class="hljs-keyword">null</span><br>        ? String.format(<span class="hljs-string">&quot;Optional[%s]&quot;</span>, value)<br>        : <span class="hljs-string">&quot;Optional.empty&quot;</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h1 id="干点有趣的事"><a href="#干点有趣的事" class="headerlink" title="干点有趣的事"></a>干点有趣的事</h1><p>没什么用就当写着玩了</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">//随机数100个</span><br>    List&lt;Map&lt;String, Optional&lt;Integer&gt;&gt;&gt; mapList = <span class="hljs-keyword">new</span> Random().ints(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>).limit(<span class="hljs-number">100</span>).boxed().collect(() -&gt; &#123;<br>        List&lt;Map&lt;String, Optional&lt;Integer&gt;&gt;&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        Map&lt;String, Optional&lt;Integer&gt;&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;(<span class="hljs-number">2</span>);<br>        map.put(Thread.currentThread().getName(), Optional.empty());<br>        list.add(map);<br>        <span class="hljs-keyword">return</span> list;<br>    &#125;, (lastList, value) -&gt; &#123;<br>        Map&lt;String, Optional&lt;Integer&gt;&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;(<span class="hljs-number">2</span>);<br>        map.put(Thread.currentThread().getName(), Optional.of(value));<br>        lastList.add(map);<br>    &#125;, List::addAll);<br>    <span class="hljs-comment">//做个筛选</span><br>    IntSummaryStatistics intSummaryStatistics = mapList.stream().map(x -&gt; &#123;<br>        System.out.println(Arrays.toString(x.keySet().toArray()));<br>        <span class="hljs-keyword">return</span> x.values();<br>    &#125;).flatMap(Collection::stream)<br>        .mapToInt(x -&gt; x.map(y -&gt; y - <span class="hljs-number">50</span>).orElse(<span class="hljs-number">0</span>)).summaryStatistics();<br>    System.out.printf(<span class="hljs-string">&quot;MAX: %d MIN: %d AVE: %f SUM: %d COUNT: %d&quot;</span>,<br>                      intSummaryStatistics.getMax(),<br>                      intSummaryStatistics.getMin(),<br>                      intSummaryStatistics.getAverage(),<br>                      intSummaryStatistics.getSum(),<br>                      intSummaryStatistics.getCount()<br>                     );<br>&#125;<br></code></pre></div></td></tr></table></figure></div><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/categories/%E8%AF%AD%E9%9B%80/">语雀</a></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a class="hover-with-bg" href="/tags/%E8%AF%AD%E9%9B%80/">语雀</a> <a class="hover-with-bg" href="/tags/Java/">Java</a></div></div><p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p><div class="post-prevnext"><article class="post-prev col-6"><a href="/918110f64071.html"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">毒瓶子二进制法</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/e6ddddcf68e6.html"><span class="hidden-mobile">SpringBoot 请求 (随笔写的很少)</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article class="comments" id="comments" lazyload><div id="valine"></div><script type="text/javascript">Fluid.utils.loadComments("#valine",(function(){Fluid.utils.createScript("https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js",(function(){var e=Object.assign({appId:"XhzUk14bCmCVREHE5ROg559J-MdYXbMMI",appKey:"c8Fw7RQke0iYCjQb2NX4jwSW",placeholder:"说点什么...",path:"window.location.pathname",avatar:"retro",meta:["nick","mail","link"],pageSize:10,lang:"zh-CN",highlight:!0,recordIP:!0,serverURLs:"",emojiCDN:null,emojiMaps:null,enableQQ:!0,requiredFields:[]},{el:"#valine",path:window.location.pathname});new Valine(e)}))}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></div></div></div><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer class="text-center mt-5 py-3"><div class="footer-content">Powered By - <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> Theme - <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a><div style="font-size:.85rem"><span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span><script src="/js/duration.js"></script></div></div><div class="statistics"><span id="leancloud-site-pv-container" style="display:none">总访问量 <span id="leancloud-site-pv"></span> 次 </span><span id="leancloud-site-uv-container" style="display:none">总访客数 <span id="leancloud-site-uv"></span> 人</span></div></footer><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/img-lazyload.js"></script><script src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"></script><script src="/js/local-search.js"></script><script defer src="/js/leancloud.js"></script><script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js"></script><script>!function(t,i){(0,Fluid.plugins.typing)(i.getElementById("subtitle").title)}(window,document)</script><script defer>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?2d6a21bdd6e9c407e7e8a37193a8230b";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script defer>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","ga:192080150","auto"),ga("send","pageview")</script><script async src="https://www.google-analytics.com/analytics.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-136832726-1"></script><script defer>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-136832726-1")</script><script src="/js/boot.js"></script><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>