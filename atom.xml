<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>zea</title>
  
  
  <link href="https://blog.48626.xyz/atom.xml" rel="self"/>
  
  <link href="https://blog.48626.xyz/"/>
  <updated>2024-09-10T08:08:32.000Z</updated>
  <id>https://blog.48626.xyz/</id>
  
  <author>
    <name>初。</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>fofa扫clash v2订阅</title>
    <link href="https://blog.48626.xyz/ec3e3ea2c204.html"/>
    <id>https://blog.48626.xyz/ec3e3ea2c204.html</id>
    <published>2024-09-10T08:08:32.000Z</published>
    <updated>2024-09-10T08:08:32.000Z</updated>
    
    <content type="html"><![CDATA[<p>fofa地址：<a href="https://fofa.info/">https://fofa.info/</a></p><p>内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">body=<span class="string">&quot;port: 7890&quot;</span> &amp;&amp; body=<span class="string">&quot;socks-port: 7891&quot;</span> &amp;&amp; body=<span class="string">&quot;allow-lan: true&quot;</span></span><br></pre></td></tr></table></figure><img src="/ec3e3ea2c204/image-20240910161048448-1725955849657-2.png" class="" alt="image-20240910161048448"><p>然后随便打开一个链接，如果是下方类似内容，就导入工具测试</p><img src="/ec3e3ea2c204/image-20240910161150953.png" class="" alt="image-20240910161150953">]]></content>
    
    
    <summary type="html">&lt;p&gt;fofa地址：&lt;a href=&quot;https://fofa.info/&quot;&gt;https://fofa.info/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;内容&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;body=&lt;span class=&quot;string&quot;&gt;&amp;quot;port: 7890&amp;quot;&lt;/span&gt; &amp;amp;&amp;amp; body=&lt;span class=&quot;string&quot;&gt;&amp;quot;socks-port: 7891&amp;quot;&lt;/span&gt; &amp;amp;&amp;amp; body=&lt;span class=&quot;string&quot;&gt;&amp;quot;allow-lan: true&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="fofa" scheme="https://blog.48626.xyz/categories/fofa/"/>
    
    <category term="订阅" scheme="https://blog.48626.xyz/categories/fofa/%E8%AE%A2%E9%98%85/"/>
    
    
    <category term="fofa" scheme="https://blog.48626.xyz/tags/fofa/"/>
    
    <category term="订阅" scheme="https://blog.48626.xyz/tags/%E8%AE%A2%E9%98%85/"/>
    
  </entry>
  
  <entry>
    <title>fofa扫claude</title>
    <link href="https://blog.48626.xyz/5528c0a5beed.html"/>
    <id>https://blog.48626.xyz/5528c0a5beed.html</id>
    <published>2024-09-06T01:34:12.000Z</published>
    <updated>2024-09-06T01:34:12.000Z</updated>
    
    <content type="html"><![CDATA[<p>在fofa搜索<code>&quot;sk-ant-sid01&quot;</code><br>可以搜到标题为 <strong>Claude账号池</strong> 与 <strong>FAE-Claude 登录</strong> 的网站</p><img src="/5528c0a5beed/image-20240906093818847.png" class="" alt="image-20240906093818847"><p>直接打开f12，查找如图中红圈所示的请求，可以发现claude的key明文保存在代码里面</p><img src="/5528c0a5beed/image-20240906093838713.png" class="" alt="image-20240906093838713"><p>运气好可以拿到不少能用的，去fuclaude用就可以了（这个貌似是这个账号池项目，怎么这么草台）</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;在fofa搜索&lt;code&gt;&amp;quot;sk-ant-sid01&amp;quot;&lt;/code&gt;&lt;br&gt;可以搜到标题为 &lt;strong&gt;Claude账号池&lt;/strong&gt; 与 &lt;strong&gt;FAE-Claude 登录&lt;/strong&gt; 的网站&lt;/p&gt;
&lt;img src=&quot;/5528c0a5beed/image-20240906093818847.png&quot; class alt=&quot;image-20240906093818847&quot;&gt;



&lt;p&gt;直接打开f12，查找如图中红圈所示的请求，可以发现claude的key明文保存在代码里面&lt;/p&gt;</summary>
    
    
    
    <category term="fofa" scheme="https://blog.48626.xyz/categories/fofa/"/>
    
    <category term="claude" scheme="https://blog.48626.xyz/categories/fofa/claude/"/>
    
    
    <category term="fofa" scheme="https://blog.48626.xyz/tags/fofa/"/>
    
    <category term="claude" scheme="https://blog.48626.xyz/tags/claude/"/>
    
  </entry>
  
  <entry>
    <title>IDEA使用Docker</title>
    <link href="https://blog.48626.xyz/45112dc23ff5.html"/>
    <id>https://blog.48626.xyz/45112dc23ff5.html</id>
    <published>2024-08-25T14:05:37.000Z</published>
    <updated>2024-08-25T14:05:37.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="下载Docker-exe"><a href="#下载Docker-exe" class="headerlink" title="下载Docker.exe"></a>下载Docker.exe</h1><p>下载地址： <a href="https://download.docker.com/win/static/stable/x86_64/">https://download.docker.com/win/static/stable/x86_64/</a></p><p>随便选择一个版本</p><img src="/45112dc23ff5/image-20240825220913418.png" class="" alt="image-20240825220913418"><blockquote><p>解决的问题</p><p>cannot run program docker.exe</p></blockquote><h1 id="下载docker-buildx"><a href="#下载docker-buildx" class="headerlink" title="下载docker-buildx"></a>下载<code>docker-buildx</code></h1><p><a href="https://github.com/docker/buildx/releases/download/v0.13.1/buildx-v0.13.1.windows-amd64.exe">https://github.com/docker/buildx/releases/download/v0.13.1/buildx-v0.13.1.windows-amd64.exe</a></p><p>在你的用户文件夹下（或在文件管理地址栏输入 <code>%USERPROFILE%</code> 回车跳转到用户目录下），新建 .docker 文件夹 （注意有个“.”），下面再新建一个<code>cli-plugins</code>文件夹，将下载的文件放在该文件夹下并重命名刚刚下载的文件为 <code>docker-buildx.exe</code> 。</p><blockquote><p>解决的问题</p><p>ERROR: BuildKit is enabled but the buildx component is missing or broken.       </p><p>Install the buildx component to build images with BuildKit:      </p><p> <a href="https://docs.docker.com/go/buildx/">https://docs.docker.com/go/buildx/</a></p></blockquote><h1 id="修改IDEA设置"><a href="#修改IDEA设置" class="headerlink" title="修改IDEA设置"></a>修改IDEA设置</h1><img src="/45112dc23ff5/image-20240825221058247.png" class="" alt="image-20240825221058247">]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;下载Docker-exe&quot;&gt;&lt;a href=&quot;#下载Docker-exe&quot; class=&quot;headerlink&quot; title=&quot;下载Docker.exe&quot;&gt;&lt;/a&gt;下载Docker.exe&lt;/h1&gt;&lt;p&gt;下载地址： &lt;a href=&quot;https://download.docker.com/win/static/stable/x86_64/&quot;&gt;https://download.docker.com/win/static/stable/x86_64/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;随便选择一个版本&lt;/p&gt;</summary>
    
    
    
    <category term="Intellij" scheme="https://blog.48626.xyz/categories/Intellij/"/>
    
    
    <category term="Intellij" scheme="https://blog.48626.xyz/tags/Intellij/"/>
    
    <category term="Docker" scheme="https://blog.48626.xyz/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>Watchtower自动更新Docker容器</title>
    <link href="https://blog.48626.xyz/7e7e26f45b5f.html"/>
    <id>https://blog.48626.xyz/7e7e26f45b5f.html</id>
    <published>2024-08-25T11:24:34.000Z</published>
    <updated>2024-08-25T11:24:34.000Z</updated>
    
    <content type="html"><![CDATA[<p><code>containrrr/watchtower</code> 是一个用于自动更新 Docker 容器的工具。它通过监控运行中的容器，并自动拉取新版本的镜像来更新容器。它是一个非常有用的工具，特别是在你希望保持服务最新且最小化维护工作时。</p><h3 id="安装-Watchtower"><a href="#安装-Watchtower" class="headerlink" title="安装 Watchtower"></a>安装 Watchtower</h3><p>要开始使用 <code>watchtower</code>，首先需要安装并运行它。你可以通过以下命令来运行 <code>watchtower</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name watchtower \</span><br><span class="line">  -v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">  containrrr/watchtower</span><br></pre></td></tr></table></figure><p>这个命令执行了以下操作：</p><ul><li><code>-d</code>：以分离模式运行 <code>watchtower</code>。</li><li><code>--name watchtower</code>：将容器命名为 <code>watchtower</code>。</li><li><code>-v /var/run/docker.sock:/var/run/docker.sock</code>：将 Docker 的 Unix 套接字文件挂载到容器内，使 <code>watchtower</code> 能够与 Docker 守护进程通信。</li></ul><h3 id="Watchtower-的基本功能"><a href="#Watchtower-的基本功能" class="headerlink" title="Watchtower 的基本功能"></a>Watchtower 的基本功能</h3><p><code>watchtower</code> 会自动检查运行中的 Docker 容器是否有更新的镜像版本。一旦发现新版本的镜像，它会执行以下操作：</p><ol><li>拉取新的镜像版本。</li><li>停止并移除旧的容器。</li><li>使用新的镜像启动容器，保持与原始容器相同的参数（包括端口映射、挂载的卷、环境变量等）。</li></ol><h3 id="Watchtower-的高级配置"><a href="#Watchtower-的高级配置" class="headerlink" title="Watchtower 的高级配置"></a>Watchtower 的高级配置</h3><p><code>watchtower</code> 支持多种配置选项，以适应不同的使用场景。以下是一些常用的选项：</p><h4 id="1-更新间隔-interval"><a href="#1-更新间隔-interval" class="headerlink" title="1. 更新间隔 (--interval)"></a>1. 更新间隔 (<code>--interval</code>)</h4><p>默认情况下，<code>watchtower</code> 每 24 小时检查一次更新。你可以通过 <code>--interval</code> 参数自定义检查间隔时间，单位为秒。例如，每 6 小时检查一次：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name watchtower \</span><br><span class="line">  -v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">  containrrr/watchtower \</span><br><span class="line">  --interval 21600</span><br></pre></td></tr></table></figure><h4 id="2-清理旧镜像-cleanup"><a href="#2-清理旧镜像-cleanup" class="headerlink" title="2. 清理旧镜像 (--cleanup)"></a>2. 清理旧镜像 (<code>--cleanup</code>)</h4><p>每次更新后，<code>watchtower</code> 默认保留旧的镜像。你可以使用 <code>--cleanup</code> 参数来删除旧的镜像，以节省存储空间：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name watchtower \</span><br><span class="line">  -v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">  containrrr/watchtower \</span><br><span class="line">  --cleanup</span><br></pre></td></tr></table></figure><h4 id="3-运行一次-run-once"><a href="#3-运行一次-run-once" class="headerlink" title="3. 运行一次 (--run-once)"></a>3. 运行一次 (<code>--run-once</code>)</h4><p>如果你不希望 <code>watchtower</code> 持续运行并监控更新，可以使用 <code>--run-once</code> 参数，让它只检查更新一次并退出：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run --<span class="built_in">rm</span> \</span><br><span class="line">  -v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">  containrrr/watchtower \</span><br><span class="line">  --run-once</span><br></pre></td></tr></table></figure><h4 id="4-标签过滤-label-enable"><a href="#4-标签过滤-label-enable" class="headerlink" title="4. 标签过滤 (--label-enable)"></a>4. 标签过滤 (<code>--label-enable</code>)</h4><p><code>watchtower</code> 可以配置为只更新带有特定标签的容器。要启用此功能，可以使用 <code>--label-enable</code> 参数，并确保目标容器带有 <code>com.centurylinklabs.watchtower.enable=true</code> 标签。</p><p><strong>为目标容器添加标签：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name my-container \</span><br><span class="line">  --label com.centurylinklabs.watchtower.enable=<span class="literal">true</span> \</span><br><span class="line">  my-image</span><br></pre></td></tr></table></figure><p><strong>运行带有标签过滤的 Watchtower：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name watchtower \</span><br><span class="line">  -v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">  containrrr/watchtower \</span><br><span class="line">  --label-enable</span><br></pre></td></tr></table></figure><h4 id="5-特定容器更新"><a href="#5-特定容器更新" class="headerlink" title="5. 特定容器更新"></a>5. 特定容器更新</h4><p>你可以指定只更新特定容器，而不是监控所有容器。只需在运行 <code>watchtower</code> 时指定容器的名称或 ID：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name watchtower \</span><br><span class="line">  -v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">  containrrr/watchtower \</span><br><span class="line">  my-container-1 my-container-2</span><br></pre></td></tr></table></figure><h3 id="环境变量配置"><a href="#环境变量配置" class="headerlink" title="环境变量配置"></a>环境变量配置</h3><p><code>watchtower</code> 也可以通过环境变量进行配置，这对于使用 <code>docker-compose</code> 管理多个服务时非常有用。以下是一些常用的环境变量：</p><ul><li><code>WATCHTOWER_CLEANUP=true</code>：启用清理旧镜像。</li><li><code>WATCHTOWER_POLL_INTERVAL=21600</code>：设置更新检查间隔（秒）。</li><li><code>WATCHTOWER_INCLUDE_STOPPED=true</code>：包括停止的容器。</li><li><code>WATCHTOWER_MONITOR_ONLY=true</code>：只监控，不自动更新。</li></ul><h3 id="在-docker-compose-中使用-Watchtower"><a href="#在-docker-compose-中使用-Watchtower" class="headerlink" title="在 docker-compose 中使用 Watchtower"></a>在 <code>docker-compose</code> 中使用 Watchtower</h3><p>你可以在 <code>docker-compose.yml</code> 文件中添加 <code>watchtower</code> 服务，像下面这样：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">watchtower:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">containrrr/watchtower</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/run/docker.sock:/var/run/docker.sock</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">WATCHTOWER_CLEANUP=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">WATCHTOWER_POLL_INTERVAL=21600</span></span><br></pre></td></tr></table></figure><h3 id="日志与监控"><a href="#日志与监控" class="headerlink" title="日志与监控"></a>日志与监控</h3><p><code>watchtower</code> 会在其日志中记录每次更新的操作，你可以通过查看 <code>watchtower</code> 容器的日志来监控其行为：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs watchtower</span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><code>watchtower</code> 是一个强大的工具，可以帮助你自动管理 Docker 容器的更新。通过标签、容器名称过滤、清理旧镜像等功能，它提供了很大的灵活性，适合各种场景下的 Docker 容器管理需求。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;code&gt;containrrr/watchtower&lt;/code&gt; 是一个用于自动更新 Docker 容器的工具。它通过监控运行中的容器，并自动拉取新版本的镜像来更新容器。它是一个非常有用的工具，特别是在你希望保持服务最新且最小化维护工作时。&lt;/p&gt;
&lt;h3 id=&quot;安装-Watchtower&quot;&gt;&lt;a href=&quot;#安装-Watchtower&quot; class=&quot;headerlink&quot; title=&quot;安装 Watchtower&quot;&gt;&lt;/a&gt;安装 Watchtower&lt;/h3&gt;&lt;p&gt;要开始使用 &lt;code&gt;watchtower&lt;/code&gt;，首先需要安装并运行它。你可以通过以下命令来运行 &lt;code&gt;watchtower&lt;/code&gt;：&lt;/p&gt;</summary>
    
    
    
    <category term="docker" scheme="https://blog.48626.xyz/categories/docker/"/>
    
    
    <category term="docker" scheme="https://blog.48626.xyz/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>进入一个无法启动的Docker容器中故障排查</title>
    <link href="https://blog.48626.xyz/92de010fa9c7.html"/>
    <id>https://blog.48626.xyz/92de010fa9c7.html</id>
    <published>2024-08-19T07:56:42.000Z</published>
    <updated>2024-08-19T07:56:42.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="1-使用-docker-ps-a-查看容器状态"><a href="#1-使用-docker-ps-a-查看容器状态" class="headerlink" title="1. 使用 docker ps -a 查看容器状态"></a>1. 使用 <code>docker ps -a</code> 查看容器状态</h3><p>首先，确认容器的状态和容器 ID 或名称：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure><p>找到你想进入的容器，并记下它的容器 ID 或名称。</p><h3 id="2-启动容器并进入"><a href="#2-启动容器并进入" class="headerlink" title="2. 启动容器并进入"></a>2. 启动容器并进入</h3><p>如果容器因为配置文件问题无法启动，你可以使用 <code>docker run</code> 或 <code>docker start</code> 命令启动容器，然后使用 <code>docker exec</code> 命令进入容器中。</p><h4 id="方法一：通过-docker-start-启动并进入容器"><a href="#方法一：通过-docker-start-启动并进入容器" class="headerlink" title="方法一：通过 docker start 启动并进入容器"></a>方法一：通过 <code>docker start</code> 启动并进入容器</h4><ol><li>先启动容器：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start &lt;container_id_or_name&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>然后使用 <code>docker exec</code> 进入容器：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it &lt;container_id_or_name&gt; /bin/bash</span><br></pre></td></tr></table></figure><h4 id="方法二：如果容器启动后立即退出"><a href="#方法二：如果容器启动后立即退出" class="headerlink" title="方法二：如果容器启动后立即退出"></a>方法二：如果容器启动后立即退出</h4><p>在这种情况下，你可以直接使用以下命令启动一个新的临时容器，并挂载原有容器的数据卷进行调试：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --<span class="built_in">rm</span> --entrypoint /bin/bash &lt;image_name&gt; -v /path/to/container/config:/path/in/container</span><br></pre></td></tr></table></figure><p>这条命令会启动一个新的容器，进入 <code>bash</code>，并挂载原来容器的配置文件目录。</p><h3 id="3-调整启动命令以进入容器"><a href="#3-调整启动命令以进入容器" class="headerlink" title="3. 调整启动命令以进入容器"></a>3. 调整启动命令以进入容器</h3><p>如果容器是由于配置错误而无法启动的，你可以临时修改容器的启动命令。使用以下命令来启动容器并进入一个交互式 shell：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --entrypoint /bin/bash &lt;image_name&gt;</span><br></pre></td></tr></table></figure><p>在进入容器后，你可以查看和修改配置文件。</p><h3 id="4-检查并修改配置文件"><a href="#4-检查并修改配置文件" class="headerlink" title="4. 检查并修改配置文件"></a>4. 检查并修改配置文件</h3><p>进入容器后，使用 <code>cat</code>, <code>vi</code>, <code>nano</code> 等命令查看和编辑配置文件，查找可能导致问题的配置项。</p><h3 id="5-保存修改并重启容器"><a href="#5-保存修改并重启容器" class="headerlink" title="5. 保存修改并重启容器"></a>5. 保存修改并重启容器</h3><p>修改完配置文件后，退出容器并重新启动容器，看问题是否解决。</p><h3 id="6-查看容器日志"><a href="#6-查看容器日志" class="headerlink" title="6. 查看容器日志"></a>6. 查看容器日志</h3><p>如果容器无法启动，你也可以查看容器日志，帮助你诊断问题：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs &lt;container_id_or_name&gt;</span><br></pre></td></tr></table></figure><p>这将显示容器的标准输出和错误信息日志，可能会给你提供有关配置文件问题的线索。</p><p>通过以上步骤，你应该能够进入容器并检查和修改配置文件，找出导致启动失败的问题。如果仍有问题，可以根据日志或错误信息进一步排查。</p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;1-使用-docker-ps-a-查看容器状态&quot;&gt;&lt;a href=&quot;#1-使用-docker-ps-a-查看容器状态&quot; class=&quot;headerlink&quot; title=&quot;1. 使用 docker ps -a 查看容器状态&quot;&gt;&lt;/a&gt;1. 使用 &lt;code&gt;docker ps -a&lt;/code&gt; 查看容器状态&lt;/h3&gt;&lt;p&gt;首先，确认容器的状态和容器 ID 或名称：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;docker ps -a&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="docker" scheme="https://blog.48626.xyz/categories/docker/"/>
    
    
    <category term="docker" scheme="https://blog.48626.xyz/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>生成没有前导零的时间格式</title>
    <link href="https://blog.48626.xyz/a50057efe8bd.html"/>
    <id>https://blog.48626.xyz/a50057efe8bd.html</id>
    <published>2024-08-16T03:22:26.000Z</published>
    <updated>2024-08-16T03:22:26.000Z</updated>
    
    <content type="html"><![CDATA[<p>在Java编程中，处理时间格式是一个常见的任务，尤其是在需要特定时间格式输出时。对于一些应用场景，我们可能需要生成没有前导零的时间格式。例如，在一些报告或用户界面中，显示<code>9:5</code>而不是<code>09:05</code>可能看起来更自然或符合特定的设计要求。本文将详细介绍如何在Java中实现这一功能。</p><h4 id="使用SimpleDateFormat类"><a href="#使用SimpleDateFormat类" class="headerlink" title="使用SimpleDateFormat类"></a>使用<code>SimpleDateFormat</code>类</h4><p>在Java中，<code>SimpleDateFormat</code>是处理日期和时间格式的一个非常强大的工具。但是，<code>SimpleDateFormat</code>并没有直接提供去除前导零的选项。不过，我们可以通过一些简单的技巧来实现这一需求。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Calendar</span> <span class="variable">cal</span> <span class="operator">=</span> Calendar.getInstance();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 标准的时间格式，包含前导零</span></span><br><span class="line">        <span class="type">SimpleDateFormat</span> <span class="variable">sdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;HH:mm&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;标准时间（有前导零）: &quot;</span> + sdf.format(cal.getTime()));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 自定义格式去除前导零</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">customTime</span> <span class="operator">=</span> sdf.format(cal.getTime())</span><br><span class="line">            .replaceFirst(<span class="string">&quot;^0+(?!$)&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">            .replaceAll(<span class="string">&quot;:0+&quot;</span>, <span class="string">&quot;:&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;自定义时间（无前导零）: &quot;</span> + customTime);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>上面的代码示例中，我们首先创建了一个<code>SimpleDateFormat</code>对象来生成标准的时间格式。然后，通过正则表达式替换的方式去除了小时和分钟的前导零。这种方法虽然有效，但它依赖于字符串操作，可能不是最优雅的解决方案。</p><h4 id="使用DateTimeFormatter类（Java-8-）"><a href="#使用DateTimeFormatter类（Java-8-）" class="headerlink" title="使用DateTimeFormatter类（Java 8+）"></a>使用<code>DateTimeFormatter</code>类（Java 8+）</h4><p>从Java 8开始，<code>DateTimeFormatter</code>类提供了更强大和灵活的日期时间格式化选项。我们可以使用这个类来直接构建没有前导零的时间格式。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.time.LocalTime;</span><br><span class="line"><span class="keyword">import</span> java.time.format.DateTimeFormatter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">LocalTime</span> <span class="variable">now</span> <span class="operator">=</span> LocalTime.now();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 使用DateTimeFormatter创建没有前导零的时间格式</span></span><br><span class="line">        <span class="type">DateTimeFormatter</span> <span class="variable">dtf</span> <span class="operator">=</span> DateTimeFormatter.ofPattern(<span class="string">&quot;H:m&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;时间（无前导零）: &quot;</span> + now.format(dtf));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在这个例子中，<code>H:m</code>模式指定了小时和分钟不带前导零的格式。这种方式不仅简洁，而且是类型安全的，避免了任何可能的类型转换错误。</p><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>在Java中，根据你的Java版本和具体需求，你可以选择<code>SimpleDateFormat</code>或<code>DateTimeFormatter</code>来生成没有前导零的时间格式。对于Java 8及以上版本，推荐使用<code>DateTimeFormatter</code>因为它提供了更好的API支持和性能。通过这些工具，你可以灵活地处理时间格式，满足各种应用场景的需求。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;在Java编程中，处理时间格式是一个常见的任务，尤其是在需要特定时间格式输出时。对于一些应用场景，我们可能需要生成没有前导零的时间格式。例如，在一些报告或用户界面中，显示&lt;code&gt;9:5&lt;/code&gt;而不是&lt;code&gt;09:05&lt;/code&gt;可能看起来更自然或符合特定的设计要求。本文将详细介绍如何在Java中实现这一功能。&lt;/p&gt;
&lt;h4 id=&quot;使用SimpleDateFormat类&quot;&gt;&lt;a href=&quot;#使用SimpleDateFormat类&quot; class=&quot;headerlink&quot; title=&quot;使用SimpleDateFormat类&quot;&gt;&lt;/a&gt;使用&lt;code&gt;SimpleDateFormat&lt;/code&gt;类&lt;/h4&gt;&lt;p&gt;在Java中，&lt;code&gt;SimpleDateFormat&lt;/code&gt;是处理日期和时间格式的一个非常强大的工具。但是，&lt;code&gt;SimpleDateFormat&lt;/code&gt;并没有直接提供去除前导零的选项。不过，我们可以通过一些简单的技巧来实现这一需求。&lt;/p&gt;</summary>
    
    
    
    <category term="Java" scheme="https://blog.48626.xyz/categories/Java/"/>
    
    
    <category term="Java" scheme="https://blog.48626.xyz/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>学生包全能油猴脚本[定位 + 摄像头]</title>
    <link href="https://blog.48626.xyz/2643f6ab131b.html"/>
    <id>https://blog.48626.xyz/2643f6ab131b.html</id>
    <published>2024-08-15T03:59:14.000Z</published>
    <updated>2024-08-15T03:59:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>安装后会在 education[.]github[.]com 页面右上角显示一个按钮，添加图片即可。<br>定位自动从OpenStreetMap获取学校经纬度，无需任何操作，和FakeLocation插件冲突，需提前关闭Fake Location插件</p><p><a href="https://pst.innomi.net/paste/jctrbukenwwdnb2qhevfzxtm/raw">https://pst.innomi.net/paste/jctrbukenwwdnb2qhevfzxtm/raw</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ==UserScript==</span></span><br><span class="line"><span class="comment">// @name         Enhanced Virtual Camera Hook</span></span><br><span class="line"><span class="comment">// @namespace    updownup</span></span><br><span class="line"><span class="comment">// @version      1.0</span></span><br><span class="line"><span class="comment">// @description  Hook various camera APIs</span></span><br><span class="line"><span class="comment">// @match        *://education.github.com/*</span></span><br><span class="line"><span class="comment">// @match        *://webcamtests.com/*</span></span><br><span class="line"><span class="comment">// @match        *://www.veed.io/*</span></span><br><span class="line"><span class="comment">// @match        *://webcammictest.com/*</span></span><br><span class="line"><span class="comment">// @match        *://www.onlinemictest.com/*</span></span><br><span class="line"><span class="comment">// @grant        unsafeWindow</span></span><br><span class="line"><span class="comment">// @grant        GM_xmlhttpRequest</span></span><br><span class="line"><span class="comment">// @run-at       document-start</span></span><br><span class="line"><span class="comment">// ==/UserScript==</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> base64Image;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// -------- Utility Class --------</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Utils</span> &#123;</span><br><span class="line">        <span class="keyword">static</span> <span class="title function_">generateRandomBase64</span>(<span class="params">length</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> characters = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span>;</span><br><span class="line">            <span class="keyword">let</span> result = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">const</span> charactersLength = characters.<span class="property">length</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">                result += characters.<span class="title function_">charAt</span>(<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * charactersLength));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">async</span> <span class="title function_">getBase64Image</span>(<span class="params">defaultBase64Image</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> base64Image || defaultBase64Image;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// -------- Stealth UI Class --------</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">StealthUI</span> &#123;</span><br><span class="line">        <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">defaultBase64Image</span> = <span class="string">&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg==&#x27;</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">createUI</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">createUI</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> container = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">            container.<span class="property">style</span>.<span class="property">all</span> = <span class="string">&#x27;initial&#x27;</span>;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">appendChild</span>(container);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> shadow = container.<span class="title function_">attachShadow</span>(&#123; <span class="attr">mode</span>: <span class="string">&#x27;closed&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> styles = <span class="string">`</span></span><br><span class="line"><span class="string">            :host &#123; all: initial; &#125;</span></span><br><span class="line"><span class="string">            #stealth-container &#123; position: fixed; top: 0; right: 0; z-index: 2147483647; background-color: rgba(0, 0, 0, 0); padding: 0; border-radius: 7px; transition: opacity 0.3s ease-in-out, background-color 0.3s ease-in-out; font-family: Arial, sans-serif; font-size: 12px; box-sizing: border-box; width: auto; max-width: 200px; opacity: 0.1; &#125;</span></span><br><span class="line"><span class="string">            #stealth-container:hover &#123; background-color: rgba(0, 220, 0, 0.25); opacity: 1; &#125;</span></span><br><span class="line"><span class="string">            #stealth-container.hidden &#123; opacity: 0; pointer-events: none; &#125;</span></span><br><span class="line"><span class="string">            #stealth-fileInput &#123; display: none; &#125;</span></span><br><span class="line"><span class="string">            #stealth-loadButton &#123; background-color: rgba(0, 0, 0, 0); border: none; padding: 5px; border-radius: 8px; cursor: pointer; font-size: inherit; width: 100%; text-align: center; color: black; transition: background-color 0.25s ease-in-out; &#125;</span></span><br><span class="line"><span class="string">            #stealth-loadButton:hover &#123; border-radius: 3px; cursor: pointer; background-color: rgba(25, 25, 25, 0.25); &#125;</span></span><br><span class="line"><span class="string">            #stealth-loadButton.done &#123; animation: spin 2s linear infinite; &#125;</span></span><br><span class="line"><span class="string">            @keyframes spin &#123; 0% &#123; transform: rotate(0deg); &#125; 100% &#123; transform: rotate(360deg); &#125; &#125;</span></span><br><span class="line"><span class="string">        `</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> template = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;template&#x27;</span>);</span><br><span class="line">            template.<span class="property">innerHTML</span> = <span class="string">`</span></span><br><span class="line"><span class="string">            &lt;style&gt;<span class="subst">$&#123;styles&#125;</span>&lt;/style&gt;</span></span><br><span class="line"><span class="string">            &lt;div id=&quot;stealth-container&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;input type=&quot;file&quot; id=&quot;stealth-fileInput&quot; accept=&quot;image/*&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;button id=&quot;stealth-loadButton&quot;&gt;Load&lt;/button&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        `</span>;</span><br><span class="line"></span><br><span class="line">            shadow.<span class="title function_">appendChild</span>(template.<span class="property">content</span>.<span class="title function_">cloneNode</span>(<span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> stealthContainer = shadow.<span class="title function_">getElementById</span>(<span class="string">&#x27;stealth-container&#x27;</span>);</span><br><span class="line">            <span class="keyword">const</span> fileInput = shadow.<span class="title function_">getElementById</span>(<span class="string">&#x27;stealth-fileInput&#x27;</span>);</span><br><span class="line">            <span class="keyword">const</span> loadButton = shadow.<span class="title function_">getElementById</span>(<span class="string">&#x27;stealth-loadButton&#x27;</span>);</span><br><span class="line"></span><br><span class="line">            loadButton.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">                e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">                fileInput.<span class="title function_">click</span>();</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            fileInput.<span class="property">onchange</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">                e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">                <span class="keyword">if</span> (fileInput.<span class="property">files</span> &amp;&amp; fileInput.<span class="property">files</span>[<span class="number">0</span>]) &#123;</span><br><span class="line">                    loadButton.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;done&#x27;</span>);</span><br><span class="line">                    loadButton.<span class="property">textContent</span> = <span class="string">&#x27;...&#x27;</span>;</span><br><span class="line">                    <span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>();</span><br><span class="line">                    reader.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">                        base64Image = e.<span class="property">target</span>.<span class="property">result</span>;</span><br><span class="line">                        loadButton.<span class="property">textContent</span> = <span class="string">&#x27;√&#x27;</span>;</span><br><span class="line">                    &#125;;</span><br><span class="line">                    reader.<span class="title function_">readAsDataURL</span>(fileInput.<span class="property">files</span>[<span class="number">0</span>]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// -------- Virtual Stream Class --------</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">VirtualStream</span> &#123;</span><br><span class="line">        <span class="title function_">constructor</span>(<span class="params">width = <span class="number">1280</span>, height = <span class="number">720</span>, fps = <span class="number">30</span></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">width</span> = width;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">height</span> = height;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">fps</span> = fps;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">async</span> <span class="title function_">createNoiseLayer</span>(<span class="params">opacity = <span class="number">0.26149721</span></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> canvas = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;canvas&#x27;</span>);</span><br><span class="line">            canvas.<span class="property">width</span> = <span class="variable language_">this</span>.<span class="property">width</span>;</span><br><span class="line">            canvas.<span class="property">height</span> = <span class="variable language_">this</span>.<span class="property">height</span>;</span><br><span class="line">            <span class="keyword">const</span> ctx = canvas.<span class="title function_">getContext</span>(<span class="string">&#x27;2d&#x27;</span>);</span><br><span class="line">            <span class="keyword">const</span> imageData = ctx.<span class="title function_">createImageData</span>(<span class="variable language_">this</span>.<span class="property">width</span>, <span class="variable language_">this</span>.<span class="property">height</span>);</span><br><span class="line">            <span class="keyword">const</span> data = imageData.<span class="property">data</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">                <span class="keyword">const</span> noise = <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">255</span>;</span><br><span class="line">                data[i] = data[i + <span class="number">1</span>] = data[i + <span class="number">2</span>] = noise;</span><br><span class="line">                data[i + <span class="number">3</span>] = opacity * <span class="number">255</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            ctx.<span class="title function_">putImageData</span>(imageData, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> canvas;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">drawImageCovered</span>(<span class="params">ctx, img, x, y, w, h</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> imgRatio = img.<span class="property">width</span> / img.<span class="property">height</span>;</span><br><span class="line">            <span class="keyword">const</span> canvasRatio = w / h;</span><br><span class="line">            <span class="keyword">let</span> sx, sy, sWidth, sHeight;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (imgRatio &gt; canvasRatio) &#123;</span><br><span class="line">                sHeight = img.<span class="property">height</span>;</span><br><span class="line">                sWidth = sHeight * canvasRatio;</span><br><span class="line">                sx = (img.<span class="property">width</span> - sWidth) / <span class="number">2</span>;</span><br><span class="line">                sy = <span class="number">0</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                sWidth = img.<span class="property">width</span>;</span><br><span class="line">                sHeight = sWidth / canvasRatio;</span><br><span class="line">                sx = <span class="number">0</span>;</span><br><span class="line">                sy = (img.<span class="property">height</span> - sHeight) / <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            ctx.<span class="title function_">drawImage</span>(img, sx, sy, sWidth, sHeight, x, y, w, h);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">async</span> <span class="title function_">createDynamicFilteredStream</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> canvas = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;canvas&#x27;</span>);</span><br><span class="line">            canvas.<span class="property">width</span> = <span class="variable language_">this</span>.<span class="property">width</span>;</span><br><span class="line">            canvas.<span class="property">height</span> = <span class="variable language_">this</span>.<span class="property">height</span>;</span><br><span class="line">            <span class="keyword">const</span> ctx = canvas.<span class="title function_">getContext</span>(<span class="string">&#x27;2d&#x27;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> img = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">            img.<span class="property">src</span> = <span class="keyword">await</span> <span class="title class_">Utils</span>.<span class="title function_">getBase64Image</span>(<span class="keyword">new</span> <span class="title class_">StealthUI</span>().<span class="property">defaultBase64Image</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> offscreenCanvas = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;canvas&#x27;</span>);</span><br><span class="line">            offscreenCanvas.<span class="property">width</span> = <span class="variable language_">this</span>.<span class="property">width</span>;</span><br><span class="line">            offscreenCanvas.<span class="property">height</span> = <span class="variable language_">this</span>.<span class="property">height</span>;</span><br><span class="line">            <span class="keyword">const</span> offscreenCtx = offscreenCanvas.<span class="title function_">getContext</span>(<span class="string">&#x27;2d&#x27;</span>);</span><br><span class="line"></span><br><span class="line">            img.<span class="property">onload</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">drawImageCovered</span>(offscreenCtx, img, <span class="number">0</span>, <span class="number">0</span>, offscreenCanvas.<span class="property">width</span>, offscreenCanvas.<span class="property">height</span>);</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> noiseLayer = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">createNoiseLayer</span>();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> hue = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">let</span> saturate = <span class="number">100</span>;</span><br><span class="line">            <span class="keyword">let</span> brightness = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">function</span> <span class="title function_">generateFrame</span>(<span class="params"></span>) &#123;</span><br><span class="line">                hue = (hue + <span class="number">0.1</span>) % <span class="number">2</span>;</span><br><span class="line">                saturate = <span class="number">99</span> + <span class="title class_">Math</span>.<span class="title function_">sin</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>() / <span class="number">1000</span>) * <span class="title class_">Math</span>.<span class="title function_">random</span>();</span><br><span class="line">                brightness = <span class="number">98</span> + <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">                ctx.<span class="title function_">clearRect</span>(<span class="number">0</span>, <span class="number">0</span>, canvas.<span class="property">width</span>, canvas.<span class="property">height</span>);</span><br><span class="line">                ctx.<span class="title function_">drawImage</span>(offscreenCanvas, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">                ctx.<span class="property">filter</span> = <span class="string">`hue-rotate(<span class="subst">$&#123;hue&#125;</span>deg) saturate(<span class="subst">$&#123;saturate&#125;</span>%) brightness(<span class="subst">$&#123;brightness&#125;</span>%)`</span>;</span><br><span class="line">                ctx.<span class="title function_">drawImage</span>(canvas, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">                ctx.<span class="property">filter</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">                ctx.<span class="property">globalCompositeOperation</span> = <span class="string">&#x27;overlay&#x27;</span>;</span><br><span class="line">                ctx.<span class="title function_">drawImage</span>(noiseLayer, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">                ctx.<span class="property">globalCompositeOperation</span> = <span class="string">&#x27;source-over&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> stream = canvas.<span class="title function_">captureStream</span>(<span class="variable language_">this</span>.<span class="property">fps</span>);</span><br><span class="line"></span><br><span class="line">            <span class="built_in">setInterval</span>(generateFrame, <span class="number">1000</span> / <span class="variable language_">this</span>.<span class="property">fps</span>);</span><br><span class="line"></span><br><span class="line">            <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                noiseLayer = <span class="variable language_">this</span>.<span class="title function_">createNoiseLayer</span>();</span><br><span class="line">            &#125;, <span class="number">100</span> + <span class="title class_">Math</span>.<span class="title function_">sin</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>() / <span class="number">1000</span>) * <span class="number">150</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> stream;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">async</span> <span class="title function_">createWebGLFilteredStream</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> canvas = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;canvas&#x27;</span>);</span><br><span class="line">            canvas.<span class="property">width</span> = <span class="variable language_">this</span>.<span class="property">width</span>;</span><br><span class="line">            canvas.<span class="property">height</span> = <span class="variable language_">this</span>.<span class="property">height</span>;</span><br><span class="line">            <span class="keyword">const</span> gl = canvas.<span class="title function_">getContext</span>(<span class="string">&#x27;webgl&#x27;</span>) || canvas.<span class="title function_">getContext</span>(<span class="string">&#x27;experimental-webgl&#x27;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!gl) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;WebGL not supported, falling back to 2D canvas&#x27;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">createDynamicFilteredStream</span>();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> vertexShaderSource = <span class="string">`</span></span><br><span class="line"><span class="string">                attribute vec2 a_position;</span></span><br><span class="line"><span class="string">                attribute vec2 a_texCoord;</span></span><br><span class="line"><span class="string">                varying vec2 v_texCoord;</span></span><br><span class="line"><span class="string">                void main() &#123;</span></span><br><span class="line"><span class="string">                    gl_Position = vec4(a_position, 0, 1);</span></span><br><span class="line"><span class="string">                    v_texCoord = a_texCoord;</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">            `</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> fragmentShaderSource = <span class="string">`</span></span><br><span class="line"><span class="string">                precision mediump float;</span></span><br><span class="line"><span class="string">                uniform sampler2D u_image;</span></span><br><span class="line"><span class="string">                uniform sampler2D u_noise;</span></span><br><span class="line"><span class="string">                uniform float u_time;</span></span><br><span class="line"><span class="string">                uniform vec2 u_noiseOffset;</span></span><br><span class="line"><span class="string">                varying vec2 v_texCoord;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                vec3 rgb2hsv(vec3 c) &#123;</span></span><br><span class="line"><span class="string">                    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);</span></span><br><span class="line"><span class="string">                    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));</span></span><br><span class="line"><span class="string">                    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));</span></span><br><span class="line"><span class="string">                    float d = q.x - min(q.w, q.y);</span></span><br><span class="line"><span class="string">                    float e = 1.0e-10;</span></span><br><span class="line"><span class="string">                    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                vec3 hsv2rgb(vec3 c) &#123;</span></span><br><span class="line"><span class="string">                    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);</span></span><br><span class="line"><span class="string">                    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);</span></span><br><span class="line"><span class="string">                    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                void main() &#123;</span></span><br><span class="line"><span class="string">                    vec4 color = texture2D(u_image, vec2(v_texCoord.x, 1.0 - v_texCoord.y));</span></span><br><span class="line"><span class="string">                    vec4 noise = texture2D(u_noise, v_texCoord * 4.0 + u_noiseOffset);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                    vec3 hsv = rgb2hsv(color.rgb);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                    float saturationAdjust = 0.99 + sin(u_time * 0.002) * 0.01;</span></span><br><span class="line"><span class="string">                    hsv.y *= saturationAdjust;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                    float brightnessAdjust = 0.98 + 0.02 * fract(sin(dot(v_texCoord, vec2(12.9898, 78.233))) * 43758.5453);</span></span><br><span class="line"><span class="string">                    hsv.z *= brightnessAdjust;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                    vec3 rgb = hsv2rgb(hsv);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                    gl_FragColor = vec4(rgb, color.a) + noise * 0.1;</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">            `</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">function</span> <span class="title function_">createShader</span>(<span class="params">gl, type, source</span>) &#123;</span><br><span class="line">                <span class="keyword">const</span> shader = gl.<span class="title function_">createShader</span>(type);</span><br><span class="line">                gl.<span class="title function_">shaderSource</span>(shader, source);</span><br><span class="line">                gl.<span class="title function_">compileShader</span>(shader);</span><br><span class="line">                <span class="keyword">if</span> (!gl.<span class="title function_">getShaderParameter</span>(shader, gl.<span class="property">COMPILE_STATUS</span>)) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;An error occurred compiling the shaders: &#x27;</span> + gl.<span class="title function_">getShaderInfoLog</span>(shader));</span><br><span class="line">                    gl.<span class="title function_">deleteShader</span>(shader);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> shader;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> vertexShader = <span class="title function_">createShader</span>(gl, gl.<span class="property">VERTEX_SHADER</span>, vertexShaderSource);</span><br><span class="line">            <span class="keyword">const</span> fragmentShader = <span class="title function_">createShader</span>(gl, gl.<span class="property">FRAGMENT_SHADER</span>, fragmentShaderSource);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> program = gl.<span class="title function_">createProgram</span>();</span><br><span class="line">            gl.<span class="title function_">attachShader</span>(program, vertexShader);</span><br><span class="line">            gl.<span class="title function_">attachShader</span>(program, fragmentShader);</span><br><span class="line">            gl.<span class="title function_">linkProgram</span>(program);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!gl.<span class="title function_">getProgramParameter</span>(program, gl.<span class="property">LINK_STATUS</span>)) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Unable to initialize the shader program: &#x27;</span> + gl.<span class="title function_">getProgramInfoLog</span>(program));</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> positionBuffer = gl.<span class="title function_">createBuffer</span>();</span><br><span class="line">            gl.<span class="title function_">bindBuffer</span>(gl.<span class="property">ARRAY_BUFFER</span>, positionBuffer);</span><br><span class="line">            gl.<span class="title function_">bufferData</span>(gl.<span class="property">ARRAY_BUFFER</span>, <span class="keyword">new</span> <span class="title class_">Float32Array</span>([</span><br><span class="line">                -<span class="number">1</span>, -<span class="number">1</span>,</span><br><span class="line">                <span class="number">1</span>, -<span class="number">1</span>,</span><br><span class="line">                -<span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">                <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">            ]), gl.<span class="property">STATIC_DRAW</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> texCoordBuffer = gl.<span class="title function_">createBuffer</span>();</span><br><span class="line">            gl.<span class="title function_">bindBuffer</span>(gl.<span class="property">ARRAY_BUFFER</span>, texCoordBuffer);</span><br><span class="line">            gl.<span class="title function_">bufferData</span>(gl.<span class="property">ARRAY_BUFFER</span>, <span class="keyword">new</span> <span class="title class_">Float32Array</span>([</span><br><span class="line">                <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">                <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">                <span class="number">0</span>, <span class="number">1</span>,</span><br><span class="line">                <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">            ]), gl.<span class="property">STATIC_DRAW</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> positionLocation = gl.<span class="title function_">getAttribLocation</span>(program, <span class="string">&#x27;a_position&#x27;</span>);</span><br><span class="line">            <span class="keyword">const</span> texCoordLocation = gl.<span class="title function_">getAttribLocation</span>(program, <span class="string">&#x27;a_texCoord&#x27;</span>);</span><br><span class="line"></span><br><span class="line">            gl.<span class="title function_">useProgram</span>(program);</span><br><span class="line">            gl.<span class="title function_">enableVertexAttribArray</span>(positionLocation);</span><br><span class="line">            gl.<span class="title function_">enableVertexAttribArray</span>(texCoordLocation);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> imageTexture = gl.<span class="title function_">createTexture</span>();</span><br><span class="line">            gl.<span class="title function_">bindTexture</span>(gl.<span class="property">TEXTURE_2D</span>, imageTexture);</span><br><span class="line">            gl.<span class="title function_">texParameteri</span>(gl.<span class="property">TEXTURE_2D</span>, gl.<span class="property">TEXTURE_WRAP_S</span>, gl.<span class="property">CLAMP_TO_EDGE</span>);</span><br><span class="line">            gl.<span class="title function_">texParameteri</span>(gl.<span class="property">TEXTURE_2D</span>, gl.<span class="property">TEXTURE_WRAP_T</span>, gl.<span class="property">CLAMP_TO_EDGE</span>);</span><br><span class="line">            gl.<span class="title function_">texParameteri</span>(gl.<span class="property">TEXTURE_2D</span>, gl.<span class="property">TEXTURE_MIN_FILTER</span>, gl.<span class="property">LINEAR</span>);</span><br><span class="line">            gl.<span class="title function_">texParameteri</span>(gl.<span class="property">TEXTURE_2D</span>, gl.<span class="property">TEXTURE_MAG_FILTER</span>, gl.<span class="property">LINEAR</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> img = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">            img.<span class="property">src</span> = <span class="keyword">await</span> <span class="title class_">Utils</span>.<span class="title function_">getBase64Image</span>(<span class="keyword">new</span> <span class="title class_">StealthUI</span>().<span class="property">defaultBase64Image</span>);</span><br><span class="line">            <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> img.<span class="property">onload</span> = resolve);</span><br><span class="line"></span><br><span class="line">            gl.<span class="title function_">texImage2D</span>(gl.<span class="property">TEXTURE_2D</span>, <span class="number">0</span>, gl.<span class="property">RGBA</span>, gl.<span class="property">RGBA</span>, gl.<span class="property">UNSIGNED_BYTE</span>, img);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">function</span> <span class="title function_">createNoiseTexture</span>(<span class="params">gl, size</span>) &#123;</span><br><span class="line">                <span class="keyword">const</span> pixels = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(size * size * <span class="number">4</span>);</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; pixels.<span class="property">length</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">                    <span class="keyword">const</span> noise = <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">255</span>;</span><br><span class="line">                    pixels[i] = pixels[i + <span class="number">1</span>] = pixels[i + <span class="number">2</span>] = noise;</span><br><span class="line">                    pixels[i + <span class="number">3</span>] = <span class="number">255</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">const</span> texture = gl.<span class="title function_">createTexture</span>();</span><br><span class="line">                gl.<span class="title function_">bindTexture</span>(gl.<span class="property">TEXTURE_2D</span>, texture);</span><br><span class="line">                gl.<span class="title function_">texImage2D</span>(gl.<span class="property">TEXTURE_2D</span>, <span class="number">0</span>, gl.<span class="property">RGBA</span>, size, size, <span class="number">0</span>, gl.<span class="property">RGBA</span>, gl.<span class="property">UNSIGNED_BYTE</span>, pixels);</span><br><span class="line">                gl.<span class="title function_">texParameteri</span>(gl.<span class="property">TEXTURE_2D</span>, gl.<span class="property">TEXTURE_MIN_FILTER</span>, gl.<span class="property">LINEAR</span>);</span><br><span class="line">                gl.<span class="title function_">texParameteri</span>(gl.<span class="property">TEXTURE_2D</span>, gl.<span class="property">TEXTURE_MAG_FILTER</span>, gl.<span class="property">LINEAR</span>);</span><br><span class="line">                gl.<span class="title function_">texParameteri</span>(gl.<span class="property">TEXTURE_2D</span>, gl.<span class="property">TEXTURE_WRAP_S</span>, gl.<span class="property">REPEAT</span>);</span><br><span class="line">                gl.<span class="title function_">texParameteri</span>(gl.<span class="property">TEXTURE_2D</span>, gl.<span class="property">TEXTURE_WRAP_T</span>, gl.<span class="property">REPEAT</span>);</span><br><span class="line">                <span class="keyword">return</span> texture;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> noiseTexture = <span class="title function_">createNoiseTexture</span>(gl, <span class="number">1024</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> u_image = gl.<span class="title function_">getUniformLocation</span>(program, <span class="string">&#x27;u_image&#x27;</span>);</span><br><span class="line">            <span class="keyword">const</span> u_noise = gl.<span class="title function_">getUniformLocation</span>(program, <span class="string">&#x27;u_noise&#x27;</span>);</span><br><span class="line">            <span class="keyword">const</span> u_time = gl.<span class="title function_">getUniformLocation</span>(program, <span class="string">&#x27;u_time&#x27;</span>);</span><br><span class="line">            <span class="keyword">const</span> u_noiseOffset = gl.<span class="title function_">getUniformLocation</span>(program, <span class="string">&#x27;u_noiseOffset&#x27;</span>);</span><br><span class="line"></span><br><span class="line">            gl.<span class="title function_">uniform1i</span>(u_image, <span class="number">0</span>);</span><br><span class="line">            gl.<span class="title function_">uniform1i</span>(u_noise, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> noiseOffsetX = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">let</span> noiseOffsetY = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">function</span> <span class="title function_">render</span>(<span class="params">time</span>) &#123;</span><br><span class="line">                gl.<span class="title function_">bindBuffer</span>(gl.<span class="property">ARRAY_BUFFER</span>, positionBuffer);</span><br><span class="line">                gl.<span class="title function_">vertexAttribPointer</span>(positionLocation, <span class="number">2</span>, gl.<span class="property">FLOAT</span>, <span class="literal">false</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">                gl.<span class="title function_">bindBuffer</span>(gl.<span class="property">ARRAY_BUFFER</span>, texCoordBuffer);</span><br><span class="line">                gl.<span class="title function_">vertexAttribPointer</span>(texCoordLocation, <span class="number">2</span>, gl.<span class="property">FLOAT</span>, <span class="literal">false</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">                gl.<span class="title function_">activeTexture</span>(gl.<span class="property">TEXTURE0</span>);</span><br><span class="line">                gl.<span class="title function_">bindTexture</span>(gl.<span class="property">TEXTURE_2D</span>, imageTexture);</span><br><span class="line"></span><br><span class="line">                gl.<span class="title function_">activeTexture</span>(gl.<span class="property">TEXTURE1</span>);</span><br><span class="line">                gl.<span class="title function_">bindTexture</span>(gl.<span class="property">TEXTURE_2D</span>, noiseTexture);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Update noise offset</span></span><br><span class="line">                noiseOffsetX = (noiseOffsetX + <span class="number">0.001</span>) % <span class="number">1</span>;</span><br><span class="line">                noiseOffsetY = (noiseOffsetY + <span class="number">0.001</span>) % <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">                gl.<span class="title function_">uniform1f</span>(u_time, time);</span><br><span class="line">                gl.<span class="title function_">uniform2f</span>(u_noiseOffset, noiseOffsetX, noiseOffsetY);</span><br><span class="line"></span><br><span class="line">                gl.<span class="title function_">drawArrays</span>(gl.<span class="property">TRIANGLE_STRIP</span>, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> fps = <span class="variable language_">this</span>.<span class="property">fps</span>;</span><br><span class="line">            <span class="keyword">const</span> stream = canvas.<span class="title function_">captureStream</span>(fps);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> lastTime = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">function</span> <span class="title function_">update</span>(<span class="params">currentTime</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (currentTime - lastTime &gt;= <span class="number">1000</span> / fps) &#123;</span><br><span class="line">                    <span class="title function_">render</span>(currentTime);</span><br><span class="line">                    lastTime = currentTime;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="title function_">requestAnimationFrame</span>(update);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="title function_">update</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> stream;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">async</span> <span class="title function_">createVirtualStream</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">createWebGLFilteredStream</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// -------- API Hook Class --------</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">APIHook</span> &#123;</span><br><span class="line">        <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">methodsLookupTable</span> = <span class="keyword">new</span> <span class="title class_">WeakMap</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">virtualDeviceId</span> = <span class="title class_">Utils</span>.<span class="title function_">generateRandomBase64</span>(<span class="number">43</span>) + <span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">virtualGroupId</span> = <span class="title class_">Utils</span>.<span class="title function_">generateRandomBase64</span>(<span class="number">43</span>) + <span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">hookMediaDevices</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">hookRTCPeerConnection</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">hookMediaStreamTrack</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">hookImageCapture</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">hookGeolocation</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title class_">Quenching</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title class_">Quenching</span>() &#123;</span><br><span class="line">            <span class="keyword">const</span> originalToString = <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>;</span><br><span class="line">            <span class="keyword">const</span> map = <span class="variable language_">this</span>.<span class="property">methodsLookupTable</span>;</span><br><span class="line"></span><br><span class="line">            <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span> = <span class="keyword">new</span> <span class="title class_">Proxy</span>(originalToString, &#123;</span><br><span class="line">                <span class="title function_">apply</span>(<span class="params">target, thisArg, argumentsList</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">typeof</span> thisArg?.<span class="property">call</span> !== <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">apply</span>(target, thisArg, argumentsList);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (map.<span class="title function_">has</span>(thisArg)) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">apply</span>(target, map.<span class="title function_">get</span>(thisArg), argumentsList);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">apply</span>(target, thisArg, argumentsList);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Helper function to replace a method with a hook</span></span><br><span class="line">        <span class="title function_">replaceMethod</span>(<span class="params">obj, methodName, newMethod</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> oldMethod = obj[methodName]</span><br><span class="line">            obj[methodName] = newMethod;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">methodsLookupTable</span>.<span class="title function_">set</span>(newMethod, oldMethod);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Hook navigator.mediaDevices methods</span></span><br><span class="line">        <span class="title function_">hookMediaDevices</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">replaceMethod</span>(navigator.<span class="property">mediaDevices</span>, <span class="string">&#x27;enumerateDevices&#x27;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">                <span class="keyword">const</span> devices = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">methodsLookupTable</span>.<span class="title function_">get</span>(navigator.<span class="property">mediaDevices</span>.<span class="property">enumerateDevices</span>).<span class="title function_">call</span>(navigator.<span class="property">mediaDevices</span>);</span><br><span class="line">                <span class="keyword">const</span> virtualDevice = <span class="keyword">new</span> <span class="title class_">MediaDeviceInfo</span>(&#123;</span><br><span class="line">                    <span class="attr">deviceId</span>: <span class="variable language_">this</span>.<span class="property">virtualDeviceId</span>,</span><br><span class="line">                    <span class="attr">groupId</span>: <span class="variable language_">this</span>.<span class="property">virtualGroupId</span>,</span><br><span class="line">                    <span class="attr">kind</span>: <span class="string">&#x27;videoinput&#x27;</span>,</span><br><span class="line">                    <span class="attr">label</span>: <span class="string">&#x27;Integrated Webcam&#x27;</span></span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="keyword">return</span> [virtualDevice, ...devices];</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">replaceMethod</span>(navigator.<span class="property">mediaDevices</span>, <span class="string">&#x27;getUserMedia&#x27;</span>, <span class="keyword">async</span> (constraints) =&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span> (constraints &amp;&amp; constraints.<span class="property">video</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">VirtualStream</span>().<span class="title function_">createVirtualStream</span>();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">methodsLookupTable</span>.<span class="title function_">get</span>(navigator.<span class="property">mediaDevices</span>.<span class="property">getUserMedia</span>).<span class="title function_">call</span>(navigator.<span class="property">mediaDevices</span>, constraints);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">replaceMethod</span>(navigator.<span class="property">mediaDevices</span>, <span class="string">&#x27;getDisplayMedia&#x27;</span>, <span class="keyword">async</span> (constraints) =&gt; &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">VirtualStream</span>().<span class="title function_">createVirtualStream</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Hook RTCPeerConnection</span></span><br><span class="line">        <span class="title function_">hookRTCPeerConnection</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">replaceMethod</span>(<span class="variable language_">window</span>, <span class="string">&#x27;RTCPeerConnection&#x27;</span>, (<span class="function"><span class="params">originalRTCPeerConnection</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">...args</span>) &#123;</span><br><span class="line">                    <span class="keyword">const</span> pc = <span class="keyword">new</span> <span class="title function_">originalRTCPeerConnection</span>(...args);</span><br><span class="line"></span><br><span class="line">                    <span class="variable language_">this</span>.<span class="title function_">replaceMethod</span>(pc, <span class="string">&#x27;addTrack&#x27;</span>, (<span class="function"><span class="params">originalAddTrack</span> =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params">...args</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (args[<span class="number">0</span>] &amp;&amp; args[<span class="number">0</span>].<span class="property">kind</span> === <span class="string">&#x27;video&#x27;</span> &amp;&amp; args[<span class="number">0</span>].<span class="title function_">getSettings</span>().<span class="property">deviceId</span> === <span class="variable language_">this</span>.<span class="property">virtualDeviceId</span>) &#123;</span><br><span class="line">                                <span class="keyword">const</span> stream = <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">VirtualStream</span>().<span class="title function_">createVirtualStream</span>();</span><br><span class="line">                                <span class="keyword">const</span> [videoTrack] = stream.<span class="title function_">getVideoTracks</span>();</span><br><span class="line">                                <span class="keyword">return</span> originalAddTrack.<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="keyword">new</span> <span class="title class_">VirtualTrack</span>(videoTrack), ...args.<span class="title function_">slice</span>(<span class="number">1</span>));</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">return</span> originalAddTrack.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">                        &#125;;</span><br><span class="line">                    &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>));</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> pc;</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>)(<span class="variable language_">window</span>.<span class="property">RTCPeerConnection</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Hook MediaStreamTrack</span></span><br><span class="line">        <span class="title function_">hookMediaStreamTrack</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">replaceMethod</span>(<span class="variable language_">window</span>, <span class="string">&#x27;MediaStreamTrack&#x27;</span>, (<span class="function"><span class="params">originalMediaStreamTrack</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">...args</span>) &#123;</span><br><span class="line">                    <span class="keyword">const</span> track = <span class="keyword">new</span> <span class="title function_">originalMediaStreamTrack</span>(...args);</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="title function_">replaceMethod</span>(track, <span class="string">&#x27;getSettings&#x27;</span>, (<span class="function"><span class="params">originalGetSettings</span> =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                            <span class="keyword">const</span> settings = originalGetSettings.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">                            <span class="keyword">if</span> (settings.<span class="property">deviceId</span> === <span class="variable language_">this</span>.<span class="property">virtualDeviceId</span>) &#123;</span><br><span class="line">                                <span class="keyword">return</span> &#123;</span><br><span class="line">                                    ...settings,</span><br><span class="line">                                    <span class="attr">deviceId</span>: <span class="variable language_">this</span>.<span class="property">virtualDeviceId</span>,</span><br><span class="line">                                    <span class="attr">groupId</span>: <span class="variable language_">this</span>.<span class="property">virtualGroupId</span>,</span><br><span class="line">                                    <span class="attr">width</span>: <span class="number">1280</span>,</span><br><span class="line">                                    <span class="attr">height</span>: <span class="number">720</span>,</span><br><span class="line">                                    <span class="attr">aspectRatio</span>: <span class="number">16</span> / <span class="number">9</span>,</span><br><span class="line">                                    <span class="attr">frameRate</span>: <span class="number">30</span>,</span><br><span class="line">                                    <span class="attr">facingMode</span>: <span class="string">&#x27;user&#x27;</span>,</span><br><span class="line">                                    <span class="attr">resizeMode</span>: <span class="string">&#x27;none&#x27;</span></span><br><span class="line">                                &#125;;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">return</span> settings;</span><br><span class="line">                        &#125;;</span><br><span class="line">                    &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>));</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> track;</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>)(<span class="variable language_">window</span>.<span class="property">MediaStreamTrack</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Hook ImageCapture</span></span><br><span class="line">        <span class="title function_">hookImageCapture</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">replaceMethod</span>(<span class="variable language_">window</span>, <span class="string">&#x27;ImageCapture&#x27;</span>, (<span class="function"><span class="params">originalImageCapture</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">track</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (track.<span class="property">kind</span> === <span class="string">&#x27;video&#x27;</span> &amp;&amp; track.<span class="title function_">getSettings</span>().<span class="property">deviceId</span> === <span class="variable language_">this</span>.<span class="property">virtualDeviceId</span>) &#123;</span><br><span class="line">                        <span class="keyword">const</span> virtualTrack = <span class="keyword">new</span> <span class="title class_">VirtualTrack</span>(track);</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">originalImageCapture</span>(virtualTrack);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">originalImageCapture</span>(track);</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>)(<span class="variable language_">window</span>.<span class="property">ImageCapture</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Geolocation Spoofing</span></span><br><span class="line">        <span class="keyword">async</span> <span class="title function_">getCoordinatesFromAddress</span>(<span class="params">address</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">GM_xmlhttpRequest</span>(&#123;</span><br><span class="line">                    <span class="attr">method</span>: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">                    <span class="attr">url</span>: <span class="string">`https://nominatim.openstreetmap.org/search?q=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(address)&#125;</span>&amp;format=json`</span>,</span><br><span class="line">                    <span class="attr">onload</span>: <span class="keyword">function</span>(<span class="params">response</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (response.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">                            <span class="keyword">const</span> data = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(response.<span class="property">responseText</span>);</span><br><span class="line">                            <span class="keyword">if</span> (data.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                                <span class="title function_">resolve</span>(&#123;</span><br><span class="line">                                    <span class="attr">latitude</span>: <span class="built_in">parseFloat</span>(data[<span class="number">0</span>].<span class="property">lat</span>),</span><br><span class="line">                                    <span class="attr">longitude</span>: <span class="built_in">parseFloat</span>(data[<span class="number">0</span>].<span class="property">lon</span>)</span><br><span class="line">                                &#125;);</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;No results found&quot;</span>));</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`Request failed with status <span class="subst">$&#123;response.status&#125;</span>`</span>));</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">onerror</span>: <span class="keyword">function</span>(<span class="params">error</span>) &#123;</span><br><span class="line">                        <span class="title function_">reject</span>(error);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">getRandomOffset</span>(<span class="params">maxOffset = <span class="number">0.00005</span></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="title class_">Math</span>.<span class="title function_">random</span>() - <span class="number">0.5</span>) * <span class="number">2</span> * maxOffset;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">async</span> <span class="title function_">updateMockedGeolocation</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> schoolInput = <span class="variable language_">document</span>.evaluate(<span class="string">&#x27;//*[@id=&quot;school-input&quot;]&#x27;</span>, <span class="variable language_">document</span>, <span class="literal">null</span>, <span class="title class_">XPathResult</span>.<span class="property">FIRST_ORDERED_NODE_TYPE</span>, <span class="literal">null</span>).<span class="property">singleNodeValue</span>;</span><br><span class="line">            <span class="keyword">if</span> (schoolInput &amp;&amp; schoolInput.<span class="property">value</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">const</span> coordinates = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">getCoordinatesFromAddress</span>(schoolInput.<span class="property">value</span>);</span><br><span class="line">                    <span class="keyword">if</span> (coordinates) &#123;</span><br><span class="line">                        <span class="variable language_">this</span>.<span class="property">mockedGeolocation</span> = &#123;</span><br><span class="line">                            <span class="attr">latitude</span>: coordinates.<span class="property">latitude</span> + <span class="variable language_">this</span>.<span class="title function_">getRandomOffset</span>(),</span><br><span class="line">                            <span class="attr">longitude</span>: coordinates.<span class="property">longitude</span> + <span class="variable language_">this</span>.<span class="title function_">getRandomOffset</span>(),</span><br><span class="line">                            <span class="attr">accuracy</span>: <span class="number">30</span> + <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">20</span></span><br><span class="line">                        &#125;;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Error updating mocked geolocation:&quot;</span>, error);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Hook Geolocation</span></span><br><span class="line">        <span class="title function_">hookGeolocation</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">replaceMethod</span>(navigator.<span class="property">geolocation</span>, <span class="string">&#x27;getCurrentPosition&#x27;</span>, <span class="keyword">async</span> (successCallback, errorCallback, options) =&gt; &#123;</span><br><span class="line">                <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">updateMockedGeolocation</span>();</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">mockedGeolocation</span>) &#123;</span><br><span class="line">                    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                        <span class="title function_">successCallback</span>(&#123;</span><br><span class="line">                            <span class="attr">coords</span>: &#123;</span><br><span class="line">                                <span class="attr">latitude</span>: <span class="variable language_">this</span>.<span class="property">mockedGeolocation</span>.<span class="property">latitude</span>,</span><br><span class="line">                                <span class="attr">longitude</span>: <span class="variable language_">this</span>.<span class="property">mockedGeolocation</span>.<span class="property">longitude</span>,</span><br><span class="line">                                <span class="attr">accuracy</span>: <span class="variable language_">this</span>.<span class="property">mockedGeolocation</span>.<span class="property">accuracy</span></span><br><span class="line">                            &#125;,</span><br><span class="line">                            <span class="attr">timestamp</span>: <span class="title class_">Date</span>.<span class="title function_">now</span>()</span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;, <span class="number">2500</span> + <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">500</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">methodsLookupTable</span>.<span class="title function_">get</span>(navigator.<span class="property">geolocation</span>.<span class="property">getCurrentPosition</span>).<span class="title function_">call</span>(navigator.<span class="property">geolocation</span>, successCallback, errorCallback, options);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">replaceMethod</span>(navigator.<span class="property">geolocation</span>, <span class="string">&#x27;watchPosition&#x27;</span>, <span class="keyword">async</span> (successCallback, errorCallback, options) =&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">mockedGeolocation</span>) &#123;</span><br><span class="line">                    <span class="keyword">const</span> watchId = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                        navigator.<span class="property">geolocation</span>.<span class="title function_">getCurrentPosition</span>(successCallback, errorCallback, options);</span><br><span class="line">                    &#125;, <span class="number">5000</span>);</span><br><span class="line">                    <span class="keyword">return</span> watchId;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">methodsLookupTable</span>.<span class="title function_">get</span>(navigator.<span class="property">geolocation</span>.<span class="property">watchPosition</span>).<span class="title function_">call</span>(navigator.<span class="property">geolocation</span>, successCallback, errorCallback, options);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">replaceMethod</span>(navigator.<span class="property">geolocation</span>, <span class="string">&#x27;clearWatch&#x27;</span>, <span class="function">(<span class="params">watchId</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="built_in">clearInterval</span>(watchId);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// -------- Virtual Track Class --------</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">VirtualTrack</span> &#123;</span><br><span class="line">        <span class="title function_">constructor</span>(<span class="params">originalTrack</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">originalTrack</span> = originalTrack;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">enabled</span> = <span class="literal">true</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">muted</span> = <span class="literal">false</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">constraints</span> = &#123;&#125;;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">settings</span> = &#123;</span><br><span class="line">                <span class="attr">deviceId</span>: <span class="variable language_">this</span>.<span class="property">virtualDeviceId</span>,</span><br><span class="line">                <span class="attr">groupId</span>: <span class="variable language_">this</span>.<span class="property">virtualGroupId</span>,</span><br><span class="line">                <span class="attr">width</span>: <span class="number">1280</span>,</span><br><span class="line">                <span class="attr">height</span>: <span class="number">720</span>,</span><br><span class="line">                <span class="attr">aspectRatio</span>: <span class="number">16</span> / <span class="number">9</span>,</span><br><span class="line">                <span class="attr">frameRate</span>: <span class="number">30</span>,</span><br><span class="line">                <span class="attr">facingMode</span>: <span class="string">&#x27;user&#x27;</span></span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">get</span> <span class="title function_">id</span>() &#123; <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">virtualDeviceId</span>; &#125;</span><br><span class="line">        <span class="keyword">get</span> <span class="title function_">kind</span>() &#123; <span class="keyword">return</span> <span class="string">&#x27;video&#x27;</span>; &#125;</span><br><span class="line">        <span class="keyword">get</span> <span class="title function_">label</span>() &#123; <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>; &#125;</span><br><span class="line">        <span class="keyword">get</span> <span class="title function_">enabled</span>() &#123; <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">enabled</span>; &#125;</span><br><span class="line">        <span class="keyword">get</span> <span class="title function_">muted</span>() &#123; <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">muted</span>; &#125;</span><br><span class="line">        <span class="keyword">get</span> <span class="title function_">readyState</span>() &#123; <span class="keyword">return</span> <span class="string">&#x27;live&#x27;</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">getConstraints</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> &#123; ...<span class="variable language_">this</span>.<span class="property">constraints</span> &#125;; &#125;</span><br><span class="line">        <span class="title function_">getSettings</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> &#123; ...<span class="variable language_">this</span>.<span class="property">settings</span> &#125;; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">getCapabilities</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="attr">width</span>: &#123; <span class="attr">min</span>: <span class="number">640</span>, <span class="attr">max</span>: <span class="number">1920</span> &#125;,</span><br><span class="line">                <span class="attr">height</span>: &#123; <span class="attr">min</span>: <span class="number">480</span>, <span class="attr">max</span>: <span class="number">1080</span> &#125;,</span><br><span class="line">                <span class="attr">aspectRatio</span>: &#123; <span class="attr">min</span>: <span class="number">1.33</span>, <span class="attr">max</span>: <span class="number">1.78</span> &#125;,</span><br><span class="line">                <span class="attr">frameRate</span>: &#123; <span class="attr">min</span>: <span class="number">15</span>, <span class="attr">max</span>: <span class="number">60</span> &#125;,</span><br><span class="line">                <span class="attr">facingMode</span>: [<span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;environment&#x27;</span>],</span><br><span class="line">                <span class="attr">resizeMode</span>: [<span class="string">&#x27;none&#x27;</span>, <span class="string">&#x27;crop-and-scale&#x27;</span>]</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">async</span> <span class="title function_">applyConstraints</span>(<span class="params">newConstraints</span>) &#123;</span><br><span class="line">            <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="variable language_">this</span>.<span class="property">constraints</span>, newConstraints);</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">stop</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">enabled</span> = <span class="literal">false</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">originalTrack</span>.<span class="title function_">stop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --------  Modify MediaDeviceInfo --------</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title class_">OriginalMediaDeviceInfo</span> = unsafeWindow.<span class="property">MediaDeviceInfo</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">MediaDeviceInfo</span>(<span class="params">&#123; deviceId, groupId, kind, label &#125;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!(<span class="variable language_">this</span> <span class="keyword">instanceof</span> <span class="title class_">MediaDeviceInfo</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MediaDeviceInfo</span>(&#123; deviceId, groupId, kind, label &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">defineProperties</span>(<span class="variable language_">this</span>, &#123;</span><br><span class="line">            <span class="attr">deviceId</span>: &#123;</span><br><span class="line">                <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> deviceId; &#125;,</span><br><span class="line">                <span class="attr">enumerable</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">groupId</span>: &#123;</span><br><span class="line">                <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> groupId; &#125;,</span><br><span class="line">                <span class="attr">enumerable</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">kind</span>: &#123;</span><br><span class="line">                <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> kind; &#125;,</span><br><span class="line">                <span class="attr">enumerable</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">label</span>: &#123;</span><br><span class="line">                <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> label; &#125;,</span><br><span class="line">                <span class="attr">enumerable</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(<span class="title class_">MediaDeviceInfo</span>, <span class="string">&#x27;length&#x27;</span>, &#123; <span class="attr">value</span>: <span class="number">0</span>, <span class="attr">writable</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">    <span class="title class_">MediaDeviceInfo</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">OriginalMediaDeviceInfo</span>.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line">    <span class="title class_">MediaDeviceInfo</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">MediaDeviceInfo</span>;</span><br><span class="line"></span><br><span class="line">    unsafeWindow.<span class="property">MediaDeviceInfo</span> = <span class="title class_">MediaDeviceInfo</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// -------- Initialize --------</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">StealthUI</span>();</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">APIHook</span>();</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Enhanced Virtual Camera Hook injected&#x27;</span>);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;安装后会在 education[.]github[.]com 页面右上角显示一个按钮，添加图片即可。&lt;br&gt;定位自动从OpenStreetMap获取学校经纬度，无需任何操作，和FakeLocation插件冲突，需提前关闭Fake Location插件&lt;/p&gt;

&lt;p&gt;&lt;a </summary>
      
    
    
    
    <category term="gitHub" scheme="https://blog.48626.xyz/categories/gitHub/"/>
    
    
    <category term="gitHub" scheme="https://blog.48626.xyz/tags/gitHub/"/>
    
  </entry>
  
  <entry>
    <title>IntelliJ IDEA Jvm配置</title>
    <link href="https://blog.48626.xyz/0621063cca74.html"/>
    <id>https://blog.48626.xyz/0621063cca74.html</id>
    <published>2024-08-05T06:17:08.000Z</published>
    <updated>2024-08-05T06:17:08.000Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">## 基础配置</span><br><span class="line"># 服务器模式运行</span><br><span class="line">-server</span><br><span class="line"># 时区编码</span><br><span class="line">-Dfile.encoding=UTF-8</span><br><span class="line">-Duser.timezone=GMT+8</span><br><span class="line"># 设置堆的初始大小和最大大小</span><br><span class="line">-Xms8g</span><br><span class="line">-Xmx32g</span><br><span class="line"># 设置元空间的初始大小和最大大小</span><br><span class="line">-XX:MetaspaceSize=1G</span><br><span class="line">-XX:MaxMetaspaceSize=2G</span><br><span class="line">-XX:MaxDirectMemorySize=2G</span><br><span class="line"></span><br><span class="line">## 垃圾回收 ZGC or ShenandoahGC</span><br><span class="line"># 启用Z Garbage Collector（ZGC）</span><br><span class="line">#-XX:+UseZGC</span><br><span class="line"># ZGC回收间隔</span><br><span class="line">#-XX:ZCollectionInterval=100</span><br><span class="line"># 使用并发标记清除（ConcMarkSweep）垃圾回收器</span><br><span class="line">#-XX:+UseConcMarkSweepGC</span><br><span class="line"># 设置并行垃圾回收线程数</span><br><span class="line">#-XX:ParallelGCThreads=20</span><br><span class="line"># 设置软引用对象在每MB堆内存中存活的最短时间</span><br><span class="line">#-XX:SoftRefLRUPolicyMSPerMB=1000</span><br><span class="line"># 虚拟机在启动时预先分配堆空间</span><br><span class="line">#-XX:+AlwaysPreTouch</span><br><span class="line"></span><br><span class="line"># 启用Shenandoah Garbage Collector（Shenandoah GC）</span><br><span class="line">-XX:+UseShenandoahGC</span><br><span class="line">-XX:+UnlockExperimentalVMOptions</span><br><span class="line"># 设置并行垃圾回收线程数（根据需要调整）</span><br><span class="line">-XX:ParallelGCThreads=20</span><br><span class="line"># 设置软引用对象在每MB堆内存中存活的最短时间</span><br><span class="line">-XX:SoftRefLRUPolicyMSPerMB=1000</span><br><span class="line"># 虚拟机在启动时预先分配堆空间</span><br><span class="line">-XX:+AlwaysPreTouch</span><br><span class="line"># 启用压缩指针（Compressed Oops）</span><br><span class="line">-XX:+UseCompressedOops</span><br><span class="line"># GC触发策略</span><br><span class="line">-XX:ShenandoahHeuristic=passive</span><br><span class="line">## 垃圾回收</span><br><span class="line"></span><br><span class="line">## JIT（即时编译）参数</span><br><span class="line"># 设置编译器线程数</span><br><span class="line">-XX:CICompilerCount=20</span><br><span class="line"># 启用分层编译</span><br><span class="line">-XX:+TieredCompilation</span><br><span class="line"># 设置停止级别，只进行第一级别的编译</span><br><span class="line">-XX:TieredStopAtLevel=1</span><br><span class="line"># 设置最大内联级别</span><br><span class="line">-XX:MaxInlineLevel=9</span><br><span class="line"># 设置第四层（Tier 4）最小调用阈值</span><br><span class="line">-XX:Tier4MinInvocationThreshold=50000</span><br><span class="line"># 设置第四层（Tier 4）调用阈值</span><br><span class="line">-XX:Tier4InvocationThreshold=100000</span><br><span class="line"># 设置第四层（Tier 4）编译阈值</span><br><span class="line"></span><br><span class="line">## 代码设置</span><br><span class="line"># 设置初始代码缓存大小和保留代码缓存大小</span><br><span class="line">-XX:InitialCodeCacheSize=1G</span><br><span class="line">-XX:ReservedCodeCacheSize=2G</span><br><span class="line"></span><br><span class="line">## 错误日志和堆转储设置</span><br><span class="line"># 在发生内存溢出错误时生成堆转储文件</span><br><span class="line">-XX:+HeapDumpOnOutOfMemoryError</span><br><span class="line"># 禁用快速抛出异常时的堆栈跟踪省略</span><br><span class="line">-XX:-OmitStackTraceInFastThrow</span><br><span class="line"># 允许自我附加</span><br><span class="line">-Djdk.attach.allowAttachSelf</span><br><span class="line"># 禁用对象晋升时的处理</span><br><span class="line">-XX:-HandlePromotionFailure</span><br><span class="line"></span><br><span class="line">## 其他设置</span><br><span class="line"># JVM激进优化</span><br><span class="line">-XX:+AggressiveOpts</span><br><span class="line"># 高随机数生成器</span><br><span class="line">-Djava.security.egd=file:/dev/./urandom</span><br><span class="line"># 启用字符串去重</span><br><span class="line">-XX:+UseStringDeduplication</span><br><span class="line"># 优化字符串连接</span><br><span class="line">-XX:+OptimizeStringConcat</span><br><span class="line"># 内存分配器</span><br><span class="line">-XX:+UseTLAB</span><br><span class="line"># 使用大页内存</span><br><span class="line">-XX:+UseLargePages</span><br><span class="line"># 文件系统缓存</span><br><span class="line">-Dsun.io.useCanonPrefixCache=false</span><br><span class="line"># 设置首选使用IPv4协议栈</span><br><span class="line">-Djava.net.preferIPv4Stack=true</span><br><span class="line"># 禁用HTTP隧道身份验证</span><br><span class="line">-Djdk.http.auth.tunneling.disabledSchemes=&quot;&quot;</span><br><span class="line"># 解锁JVM中的实验性选项</span><br><span class="line">-XX:+UnlockExperimentalVMOptions</span><br><span class="line"># 忽略不认识的JVM选项</span><br><span class="line">-XX:+IgnoreUnrecognizedVMOptions</span><br><span class="line"># 打开指定包的包访问权限</span><br><span class="line">--add-opens=java.base/jdk.internal.org.objectweb.asm=ALL-UNNAMED</span><br><span class="line">--add-opens=java.base/jdk.internal.org.objectweb.asm.tree=ALL-UNNAMED</span><br><span class="line"># JDK VisualGC 插件</span><br><span class="line">--add-exports=jdk.internal.jvmstat/sun.jvmstat.monitor=ALL-UNNAMED</span><br><span class="line">--add-exports=jdk.internal.jvmstat/sun.jvmstat.monitor.event=ALL-UNNAMED</span><br><span class="line">--add-exports=jdk.internal.jvmstat/sun.jvmstat.perfdata.monitor=ALL-UNNAMED</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span c</summary>
      
    
    
    
    <category term="Intellij" scheme="https://blog.48626.xyz/categories/Intellij/"/>
    
    
    <category term="Java" scheme="https://blog.48626.xyz/tags/Java/"/>
    
    <category term="Intellij" scheme="https://blog.48626.xyz/tags/Intellij/"/>
    
  </entry>
  
  <entry>
    <title>临时禁用 MySQL 数据库的外键约束</title>
    <link href="https://blog.48626.xyz/26bca217efa2.html"/>
    <id>https://blog.48626.xyz/26bca217efa2.html</id>
    <published>2024-07-26T08:38:36.000Z</published>
    <updated>2024-07-26T08:38:36.000Z</updated>
    
    <content type="html"><![CDATA[<p>当你需要删除数据时，可以临时禁用 MySQL 数据库的外键约束。这样，你就可以在删除操作完成后再重新启用外键约束。以下是具体的步骤：</p><p>在进行删除操作前，使用以下语句暂时禁用外键约束：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET FOREIGN_KEY_CHECKS=0;</span><br></pre></td></tr></table></figure><p>然后执行删除操作，例如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM table1 WHERE <span class="built_in">id</span>=1;</span><br></pre></td></tr></table></figure><p>删除完成后，再启用外键约束：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET FOREIGN_KEY_CHECKS=1;</span><br></pre></td></tr></table></figure><p>需要注意的是，使用这种方法禁用外键约束后，对数据进行的修改操作将不再受到外键约束的限制和检查，因此需要谨慎操作，以免影响数据的完整性和一致性。如果你只是想清空一个受外键约束的表，也可以先删除外键约束后再清空表。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;当你需要删除数据时，可以临时禁用 MySQL 数据库的外键约束。这样，你就可以在删除操作完成后再重新启用外键约束。以下是具体的步骤：&lt;/p&gt;
&lt;p&gt;在进行删除操作前，使用以下语句暂时禁用外键约束：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SET FOREIGN_KEY_CHECKS=0;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="mysql" scheme="https://blog.48626.xyz/categories/mysql/"/>
    
    
    <category term="mysql" scheme="https://blog.48626.xyz/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>docker清理没有引用的镜像</title>
    <link href="https://blog.48626.xyz/c77015022e9e.html"/>
    <id>https://blog.48626.xyz/c77015022e9e.html</id>
    <published>2024-07-23T03:25:04.000Z</published>
    <updated>2024-07-23T03:25:04.000Z</updated>
    
    <content type="html"><![CDATA[<p>在 Docker 中清理没有引用的镜像（即无标签或未被任何容器使用的镜像），可以使用以下命令：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image prune</span><br></pre></td></tr></table></figure><p>这个命令会删除所有没有被任何容器引用的镜像，释放磁盘空间。如果你希望确认删除哪些镜像，可以添加 -a 参数，这样会删除所有没有被使用的镜像，包括有标签但没有容器使用的镜像：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image prune -a</span><br></pre></td></tr></table></figure><p>如果你只想删除未被使用的镜像，但保留有标签的镜像（可能在将来会用到），可以先列出未被使用的镜像：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image <span class="built_in">ls</span> -q --filter dangling=<span class="literal">true</span></span><br></pre></td></tr></table></figure><p>然后根据这个列表手动删除每个镜像：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image <span class="built_in">rm</span> $(docker image <span class="built_in">ls</span> -q --filter dangling=<span class="literal">true</span>)</span><br></pre></td></tr></table></figure><p>这些命令可以帮助你清理掉那些不再使用的 Docker 镜像，释放磁盘空间。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;在 Docker 中清理没有引用的镜像（即无标签或未被任何容器使用的镜像），可以使用以下命令：&lt;/p&gt;
&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;docker image prune&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;这个命令会删除所有没有被任何容器引用的镜像，释放磁盘空间。如果你希望确认删除哪些镜像，可以添加 -a 参数，这样会删除所有没有被使用的镜像，包括有标签但没有容器使用的镜像：&lt;/p&gt;</summary>
    
    
    
    <category term="docker" scheme="https://blog.48626.xyz/categories/docker/"/>
    
    
    <category term="docker" scheme="https://blog.48626.xyz/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>达梦数据库备份还原</title>
    <link href="https://blog.48626.xyz/f39d21b18adb.html"/>
    <id>https://blog.48626.xyz/f39d21b18adb.html</id>
    <published>2024-07-09T14:55:26.000Z</published>
    <updated>2024-07-09T14:55:26.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>备份的文件夹：格式大致为<code>/opt/dmdbms/data/DAMENG/bak/DB_DAMENG_FULL_xxxxxxxxxxx</code><br>我当前环境为docker，所以已docker容器演示</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入docker容器</span></span><br><span class="line">docker <span class="built_in">exec</span> -it dm8 /bin/bash</span><br><span class="line"><span class="comment"># 进入指定目录</span></span><br><span class="line"><span class="built_in">cd</span> /opt/dmdbms/bin</span><br></pre></td></tr></table></figure><h2 id="关闭数据库"><a href="#关闭数据库" class="headerlink" title="关闭数据库"></a>关闭数据库</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">./disql</span><br><span class="line"><span class="comment"># 账号</span></span><br><span class="line"><span class="comment"># 密码</span></span><br><span class="line">shutdown immediate;</span><br><span class="line"><span class="comment"># 退出</span></span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure><h2 id="还原"><a href="#还原" class="headerlink" title="还原"></a>还原</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 运行还原工具</span></span><br><span class="line">./dmrman</span><br><span class="line"><span class="comment"># 执行还原命令 自行更改还原文件夹的路径和名称</span></span><br><span class="line">restore database <span class="string">&#x27;/opt/dmdbms/data/DAMENG/dm.ini&#x27;</span> from backupset <span class="string">&#x27;/opt/dmdbms/data/DAMENG/bak/DB_DAMENG_FULL_2024_05_30_00_00_00&#x27;</span>;</span><br><span class="line">recover database <span class="string">&#x27;/opt/dmdbms/data/DAMENG/dm.ini&#x27;</span> from backupset <span class="string">&#x27;/opt/dmdbms/data/DAMENG/bak/DB_DAMENG_FULL_2024_05_30_00_00_00&#x27;</span>;</span><br><span class="line">recover database <span class="string">&#x27;/opt/dmdbms/data/DAMENG/dm.ini&#x27;</span> update db_magic;</span><br><span class="line"><span class="comment"># 退出</span></span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure><p>重启检查还原情况</p><h2 id="可能出现的问题"><a href="#可能出现的问题" class="headerlink" title="可能出现的问题"></a>可能出现的问题</h2><h3 id="文件夹访问权限异常"><a href="#文件夹访问权限异常" class="headerlink" title="文件夹访问权限异常"></a>文件夹访问权限异常</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改文件夹权限</span></span><br><span class="line"><span class="built_in">chown</span> -R dmdba:dinstall DB_DAMENG_FULL_2024_05_30_00_00_00/</span><br><span class="line">su dmdba</span><br><span class="line"><span class="built_in">chown</span> -R root:root DB_DAMENG_FULL_2024_05_30_00_00_00/</span><br></pre></td></tr></table></figure><h2 id="开启归档模式"><a href="#开启归档模式" class="headerlink" title="开启归档模式"></a>开启归档模式</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ALTER DATABASE MOUNT;</span><br><span class="line">ALTER DATABASE ADD ARCHIVELOG <span class="string">&#x27;DEST = /home/dmdba/data/DAMENG/arch, TYPE = local, FILE_SIZE = 1024, SPACE_LIMIT = 2048&#x27;</span>;</span><br><span class="line">ALTER DATABASE ARCHIVELOG;</span><br><span class="line">ALTER DATABASE OPEN;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;准备工作&quot;&gt;&lt;a href=&quot;#准备工作&quot; class=&quot;headerlink&quot; title=&quot;准备工作&quot;&gt;&lt;/a&gt;准备工作&lt;/h2&gt;&lt;p&gt;备份的文件夹：格式大致为&lt;code&gt;/opt/dmdbms/data/DAMENG/bak/DB_DAMENG_FULL_xxxxxxxxxxx&lt;/code&gt;&lt;br&gt;我当前环境为docker，所以已docker容器演示&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 进入docker容器&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;docker &lt;span class=&quot;built_in&quot;&gt;exec&lt;/span&gt; -it dm8 /bin/bash&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 进入指定目录&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; /opt/dmdbms/bin&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="达梦" scheme="https://blog.48626.xyz/categories/%E8%BE%BE%E6%A2%A6/"/>
    
    
    <category term="达梦" scheme="https://blog.48626.xyz/tags/%E8%BE%BE%E6%A2%A6/"/>
    
  </entry>
  
  <entry>
    <title>打开双重el-dialog后出现遮罩</title>
    <link href="https://blog.48626.xyz/4b5ecca296b4.html"/>
    <id>https://blog.48626.xyz/4b5ecca296b4.html</id>
    <published>2024-07-08T08:46:03.000Z</published>
    <updated>2024-07-08T08:46:03.000Z</updated>
    
    <content type="html"><![CDATA[<p>环境：vue2，element</p><h2 id="打开双重el-dialog后出现遮罩"><a href="#打开双重el-dialog后出现遮罩" class="headerlink" title="打开双重el-dialog后出现遮罩"></a>打开双重el-dialog后出现遮罩</h2><img src="/4b5ecca296b4/image.png" class="" alt="alt text"><p>点击一下后</p><img src="/4b5ecca296b4/image-1.png" class="" alt="alt text"><p>这能明显的看出差距</p><h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><p>在第二个dialog添加<code>append-to-body</code></p><img src="/4b5ecca296b4/image-2.png" class="" alt="alt text">]]></content>
    
    
    <summary type="html">&lt;p&gt;环境：vue2，element&lt;/p&gt;
&lt;h2 id=&quot;打开双重el-dialog后出现遮罩&quot;&gt;&lt;a href=&quot;#打开双重el-dialog后出现遮罩&quot; class=&quot;headerlink&quot; title=&quot;打开双重el-dialog后出现遮罩&quot;&gt;&lt;/a&gt;打开双重el-dialog后出现遮罩&lt;/h2&gt;&lt;img src=&quot;/4b5ecca296b4/image.png&quot; class alt=&quot;alt text&quot;&gt;</summary>
    
    
    
    <category term="问题" scheme="https://blog.48626.xyz/categories/%E9%97%AE%E9%A2%98/"/>
    
    <category term="Vue" scheme="https://blog.48626.xyz/categories/%E9%97%AE%E9%A2%98/Vue/"/>
    
    <category term="element" scheme="https://blog.48626.xyz/categories/%E9%97%AE%E9%A2%98/Vue/element/"/>
    
    
    <category term="问题" scheme="https://blog.48626.xyz/tags/%E9%97%AE%E9%A2%98/"/>
    
    <category term="Vue" scheme="https://blog.48626.xyz/tags/Vue/"/>
    
    <category term="element" scheme="https://blog.48626.xyz/tags/element/"/>
    
  </entry>
  
  <entry>
    <title>windows执行多条命令</title>
    <link href="https://blog.48626.xyz/5a83ffea21e3.html"/>
    <id>https://blog.48626.xyz/5a83ffea21e3.html</id>
    <published>2024-07-05T08:32:03.000Z</published>
    <updated>2024-07-05T08:32:03.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><p>在 Linux 中，<code>&amp;&amp;</code> 被称为逻辑 AND 运算符。它用于将两个命令连接起来，并且只有在前一个命令成功（返回状态码为0）时，才会执行后一个命令。</p><p>例如，下面的命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">command1 &amp;&amp; command2</span><br></pre></td></tr></table></figure><p>表示先执行 <code>command1</code>，如果 <code>command1</code> 成功（返回状态码为0），则执行 <code>command2</code>。如果 <code>command1</code> 失败（返回非0状态码），则 <code>command2</code> 不会执行。</p><p>这是一个典型的用法示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> new_directory &amp;&amp; <span class="built_in">cd</span> new_directory</span><br></pre></td></tr></table></figure><p>在这个例子中，<code>mkdir new_directory</code> 成功后（目录创建成功），才会执行 <code>cd new_directory</code>（进入新创建的目录）。</p><p>这种逻辑 AND 运算符在 Bash 和大多数其他 Linux shell（如 Zsh、Ksh 等）中都可以使用。</p><h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><p>在 Windows 中的命令提示符（Command Prompt）和 PowerShell 中，分号 (<code>;</code>) 也可以用来分隔多个命令，使它们依次执行。与 <code>&amp;&amp;</code> 不同的是，使用分号分隔的命令不会检查前一个命令是否成功。</p><h3 id="在命令提示符中"><a href="#在命令提示符中" class="headerlink" title="在命令提示符中"></a>在命令提示符中</h3><p>在命令提示符中使用分号 (<code>;</code>) 作为命令分隔符不总是直观的做法，因为它可能不会像在 PowerShell 中那样一致地工作。通常建议使用 <code>&amp;</code> 或 <code>&amp;&amp;</code> 代替。</p><h3 id="在-PowerShell-中"><a href="#在-PowerShell-中" class="headerlink" title="在 PowerShell 中"></a>在 PowerShell 中</h3><p>在 PowerShell 中，分号 (<code>;</code>) 可以用于顺序执行多个命令，不管前一个命令是否成功。</p><p>例如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">command1; command2; command3</span><br></pre></td></tr></table></figure><p>这将顺序执行 <code>command1</code>，然后 <code>command2</code>，最后 <code>command3</code>，不论每个命令是否成功。</p><p>以下是具体示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean; hexo s</span><br></pre></td></tr></table></figure><p>这将执行 <code>hexo clean</code> 命令，然后立即执行 <code>hexo s</code> 命令，不考虑 <code>hexo clean</code> 的成功与否。</p><h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><ul><li>在命令提示符中，建议使用 <code>&amp;</code> 或 <code>&amp;&amp;</code>。</li><li>在 PowerShell 中，可以使用 <code>;</code> 来顺序执行命令，不管前一个命令是否成功。</li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;Linux&quot;&gt;&lt;a href=&quot;#Linux&quot; class=&quot;headerlink&quot; title=&quot;Linux&quot;&gt;&lt;/a&gt;Linux&lt;/h2&gt;&lt;p&gt;在 Linux 中，&lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt; 被称为逻辑 AND 运算符。它用于将两个命令连接起来，并且只有在前一个命令成功（返回状态码为0）时，才会执行后一个命令。&lt;/p&gt;
&lt;p&gt;例如，下面的命令：&lt;/p&gt;</summary>
    
    
    
    <category term="windows" scheme="https://blog.48626.xyz/categories/windows/"/>
    
    
    <category term="windows" scheme="https://blog.48626.xyz/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>SSH RCE 远程代码执行漏洞 POC</title>
    <link href="https://blog.48626.xyz/0f098a910aa5.html"/>
    <id>https://blog.48626.xyz/0f098a910aa5.html</id>
    <published>2024-07-04T05:04:18.000Z</published>
    <updated>2024-07-04T05:04:18.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>转载于 <a href="https://linux.do/t/topic/124906">https://linux.do/t/topic/124906</a></p></blockquote><p>SSH RCE漏洞，ssh -V检查版本，早于4.4p1 的版本受影响，<br>4.4p1 到 8.5p1（不包含8.5p1）之间的版本不受影响，<br>8.5p1到9.8p1 （不包含9.8p1）之间的版本受影响。</p><p>解决方法:<br>升级ssh版本，编译安装：</p><p>安装编译依赖</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y build-essential zlib1g-dev libssl-dev</span><br></pre></td></tr></table></figure><p>下载指定版本源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-9.8p1.tar.gz</span><br></pre></td></tr></table></figure><p>解压并进入目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -xzf openssh-9.8p1.tar.gz</span><br><span class="line"><span class="built_in">cd</span> openssh-9.8p1</span><br></pre></td></tr></table></figure><p>编译和安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure><p>重启服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart ssh</span><br></pre></td></tr></table></figure><p>断开SSH连接重连检查版本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -V</span><br></pre></td></tr></table></figure><p>OpenSSH Server远程代码执行漏洞 POC<br>Openssh Server中8.5p1和9.7p1之间的版本中存在一处条件竞争漏洞,如果客户端在120秒内没有进行身份验证（由LoginGraceTime定义的设置）,则sshd的 SIGALRM 处理程序会以一种非异步信号安全的方式异步调用,成功的利用此漏洞可以导致远程攻击者以root的权限执行远程代码</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;转载于 &lt;a href=&quot;https://linux.do/t/topic/124906&quot;&gt;https://linux.do/t/topic/124906&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;SSH RCE漏洞，ssh -V检查版本，早于4.4p1 的版本受影响，&lt;br&gt;4.4p1 到 8.5p1（不包含8.5p1）之间的版本不受影响，&lt;br&gt;8.5p1到9.8p1 （不包含9.8p1）之间的版本受影响。&lt;/p&gt;
&lt;p&gt;解决方法:&lt;br&gt;升级ssh版本，编译安装：&lt;/p&gt;</summary>
    
    
    
    <category term="Linux" scheme="https://blog.48626.xyz/categories/Linux/"/>
    
    
    <category term="Linux" scheme="https://blog.48626.xyz/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Bilihepler-personal安装</title>
    <link href="https://blog.48626.xyz/7f8d325aadf0.html"/>
    <id>https://blog.48626.xyz/7f8d325aadf0.html</id>
    <published>2024-07-03T15:34:58.000Z</published>
    <updated>2024-07-03T15:34:58.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull lkeme/bilihelper-personal:latest</span><br></pre></td></tr></table></figure><h3 id="通过环境变量进行传入"><a href="#通过环境变量进行传入" class="headerlink" title="通过环境变量进行传入"></a>通过环境变量进行传入</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --<span class="built_in">rm</span> -e USER_NAME=你的B站登录账号 -e USER_PASSWORD=你的B站密码 lkeme/bilihelper-personal</span><br></pre></td></tr></table></figure><h3 id="通过配置文件进行传入-能保留登录状态，自定义配置"><a href="#通过配置文件进行传入-能保留登录状态，自定义配置" class="headerlink" title="通过配置文件进行传入(能保留登录状态，自定义配置)"></a>通过配置文件进行传入(能保留登录状态，自定义配置)</h3><p>新建文件 profile&#x2F;user&#x2F;config&#x2F;user.ini</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#######################</span></span><br><span class="line"><span class="comment">#       程序设置       #</span></span><br><span class="line"><span class="comment">#######################</span></span><br><span class="line"></span><br><span class="line">[app]</span><br><span class="line">name = BiliHelper-personal</span><br><span class="line"><span class="built_in">env</span> = <span class="built_in">local</span></span><br><span class="line">branch = master</span><br><span class="line">version = 0.0.1</span><br><span class="line"></span><br><span class="line"><span class="comment">#######################</span></span><br><span class="line"><span class="comment">#       账户设置       #</span></span><br><span class="line"><span class="comment">#######################</span></span><br><span class="line"></span><br><span class="line">; 帐号/密码</span><br><span class="line">[login_account]</span><br><span class="line">username = <span class="string">&quot;&quot;</span></span><br><span class="line">password = <span class="string">&quot;3oU9UPvzHVkJXacb&quot;</span></span><br><span class="line"></span><br><span class="line">; 登录模式/[1.账密模式 2.短信验证码模式 3.扫码模式]</span><br><span class="line">[login_mode]</span><br><span class="line">mode = 1</span><br><span class="line"></span><br><span class="line">; 国家代码/mode=2触发/例：大陆86 澳大利亚61</span><br><span class="line">[login_country]</span><br><span class="line">code = 86</span><br><span class="line"></span><br><span class="line">; 校验/mode=2触发/校验国内手机号/国外手机号关闭校验</span><br><span class="line">[login_check]</span><br><span class="line">phone = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">[login_captcha]</span><br><span class="line">; 验证码手动识别</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">false</span></span><br><span class="line">; 验证码手动识别服务地址</span><br><span class="line">url = <span class="string">&quot;http://localhost:50001&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#######################</span></span><br><span class="line"><span class="comment">#       插件功能设置     #</span></span><br><span class="line"><span class="comment">#######################</span></span><br><span class="line"></span><br><span class="line">; 检查主程序更新</span><br><span class="line">[check_update]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">; 主站每日任务(每日登录、观看、投币、分享)</span><br><span class="line">[main_site]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">true</span></span><br><span class="line">; 获取AIDS模式/random(随机热门)/fixed(关注列表)</span><br><span class="line">fetch_aids_mode = fixed</span><br><span class="line">; 每日观看</span><br><span class="line">watch = <span class="literal">true</span></span><br><span class="line">; 每日分享</span><br><span class="line">share = <span class="literal">true</span></span><br><span class="line">; 每日视频投币/投币稿件数(每日任务最大5)</span><br><span class="line">add_coin = <span class="literal">true</span></span><br><span class="line">add_coin_num = 5</span><br><span class="line">; 当等级达到6级时停止投币</span><br><span class="line">when_lv6_stop_coin = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">; 漫画助手(每日签到、分享)</span><br><span class="line">[manga]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">; 友爱社签到</span><br><span class="line">[love_club]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">; 直播签到</span><br><span class="line">[live_sign_in]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">; 游戏赛事竞猜预测(破产机)/每日竞猜次数/每次竞猜硬币(1-10)/下注(1.压大,2.压小,3.随机)</span><br><span class="line">[game_forecast]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">false</span></span><br><span class="line">max_num = 20</span><br><span class="line">max_coin = 10</span><br><span class="line">bet = 1</span><br><span class="line"></span><br><span class="line">; 银瓜子兑换硬币</span><br><span class="line">[silver2coin]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">; 風機委員/自動連任/需要實名</span><br><span class="line">[judge]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">false</span></span><br><span class="line">auto_apply = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">; 大会员权益/年度大会员专享</span><br><span class="line">[vip_privilege]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">; B币券消费/年度大会员专享/每月默认充值数量5B币/消费方式优先级从上到下</span><br><span class="line">[bp_consumption]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">false</span></span><br><span class="line"><span class="comment"># 消费B币充电/充电的目标UID/可充值自己的UID</span></span><br><span class="line">bp2charge = <span class="literal">false</span></span><br><span class="line">bp2charge_uid = 6580464</span><br><span class="line"><span class="comment"># 消费B币充值金瓜子/5000金瓜子</span></span><br><span class="line">bp2gold = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">; 预约直播有奖/UP_UID/逗号分隔</span><br><span class="line">[live_reservation]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">true</span></span><br><span class="line">vmids = 9617619</span><br><span class="line"></span><br><span class="line">; 直播金色宝箱(实物抽奖)</span><br><span class="line">[live_gold_box]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">; 获取记录</span><br><span class="line">[award_records]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">; 大会员积分</span><br><span class="line">[vip_point]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">; 卍预约直播抽奖</span><br><span class="line">[lottery]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">; 每日电池 对应直播间ID和直播间UID</span><br><span class="line">[daily_gold]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">false</span></span><br><span class="line">target_up_id = 11153765</span><br><span class="line">target_room_id = 23058</span><br><span class="line"></span><br><span class="line">; 擦亮徽章/ 每日擦亮 默认擦亮变灰徽章</span><br><span class="line">[polish_medal]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">false</span></span><br><span class="line">everyday = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">; 批量取消关注/分组名称/默认为all(全部)</span><br><span class="line">[batch_unfollow]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">false</span></span><br><span class="line">tag = all</span><br><span class="line"></span><br><span class="line">; 转盘活动</span><br><span class="line">[activity_lottery]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#######################</span></span><br><span class="line"><span class="comment">#       通知设置       #</span></span><br><span class="line"><span class="comment">#######################</span></span><br><span class="line"></span><br><span class="line">; 消息推送/消息推送过滤词/逗号分割/优先级从上到下</span><br><span class="line">[notify]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">true</span></span><br><span class="line">filter_words = <span class="built_in">test</span>,测试</span><br><span class="line"></span><br><span class="line">; Dingtalk机器人/token/依赖USE_NOTIFY</span><br><span class="line">[notify_dingtalk]</span><br><span class="line">token =</span><br><span class="line"></span><br><span class="line">; Tele机器人/url(可选)/token/chatid/依赖USE_NOTIFY</span><br><span class="line">[notify_telegram]</span><br><span class="line">url =</span><br><span class="line">bottoken = <span class="string">&quot;&quot;</span></span><br><span class="line">chatid = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">; Pushplus酱/token/依赖USE_NOTIFY</span><br><span class="line">[notify_pushplus]</span><br><span class="line">token =</span><br><span class="line"></span><br><span class="line">; Sever酱(原版)/令牌Key/依赖USE_NOTIFY</span><br><span class="line">[notify_sc]</span><br><span class="line">sckey =</span><br><span class="line"></span><br><span class="line">; Server酱(Turbo版)/令牌Key/依赖USE_NOTIFY</span><br><span class="line">[notify_sct]</span><br><span class="line">sctkey =</span><br><span class="line"></span><br><span class="line">; GoCqhttp/url/token/目标qq/依赖USE_NOTIFY</span><br><span class="line">[notify_gocqhttp]</span><br><span class="line">url = <span class="string">&quot;&quot;</span></span><br><span class="line">token =</span><br><span class="line">target_qq =</span><br><span class="line"></span><br><span class="line">; 飞书机器人/依赖USE_NOTIFY</span><br><span class="line">[notify_feishu]</span><br><span class="line">token =</span><br><span class="line"></span><br><span class="line">; Debug/个人调试推送/url/token</span><br><span class="line">[notify_debug]</span><br><span class="line">url = <span class="string">&quot;&quot;</span></span><br><span class="line">token =</span><br><span class="line"></span><br><span class="line">; 企业微信群机器人/token</span><br><span class="line">[notify_we_com]</span><br><span class="line">token =</span><br><span class="line"></span><br><span class="line">; 企业微信应用消息/corp_id/corp_secret/agent_id/to_user</span><br><span class="line">[notify_we_com_app]</span><br><span class="line">corp_id =</span><br><span class="line">corp_secret =</span><br><span class="line">agent_id =</span><br><span class="line">to_user =</span><br><span class="line"></span><br><span class="line">; Bark/Token</span><br><span class="line">[notify_bark]</span><br><span class="line">token =</span><br><span class="line"></span><br><span class="line">; PushDeer/服务器地址/token</span><br><span class="line">[notify_push_deer]</span><br><span class="line">url =</span><br><span class="line">token =</span><br><span class="line"></span><br><span class="line"><span class="comment">#######################</span></span><br><span class="line"><span class="comment">#       网络设置       #</span></span><br><span class="line"><span class="comment">#######################</span></span><br><span class="line"></span><br><span class="line">; 验证SSL证书/请求时验证SSL证书行为</span><br><span class="line">[network_ssl]</span><br><span class="line">verify = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">; 是否使用代理/(http\https)</span><br><span class="line">[network_proxy]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">false</span></span><br><span class="line">proxy = <span class="string">&quot;http://127.0.0.1:8888&quot;</span></span><br><span class="line"></span><br><span class="line">; 是否使用自定义Github File Mirror/默认使用官方源</span><br><span class="line">[network_github]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">false</span></span><br><span class="line">mirror = </span><br><span class="line"></span><br><span class="line"><span class="comment">#######################</span></span><br><span class="line"><span class="comment">#       程序设置       #</span></span><br><span class="line"><span class="comment">#######################</span></span><br><span class="line"></span><br><span class="line">; 调试模式/采集完整日志</span><br><span class="line">[debug]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">; 记录日志/日志回调地址</span><br><span class="line">[<span class="built_in">log</span>]</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">false</span></span><br><span class="line">callback = <span class="string">&quot;http://www.example.com/api.send?text=&#123;account&#125;[&#123;level&#125;]: &#123;message&#125;&quot;</span></span><br><span class="line"><span class="comment"># 错误回调级别</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#   DEBUG   100</span></span><br><span class="line"><span class="comment">#   INFO    200</span></span><br><span class="line"><span class="comment">#   NOTICE  250</span></span><br><span class="line"><span class="comment">#   WARNING 300</span></span><br><span class="line"><span class="comment">#   ERROR   400</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">callback_level = 400</span><br><span class="line"></span><br><span class="line">; app设置</span><br><span class="line">[<span class="built_in">print</span>]</span><br><span class="line">; 用户名，可自定义</span><br><span class="line"><span class="built_in">uname</span> =</span><br><span class="line">; 账号别名，如果为空则默认使用登录账号作为标示</span><br><span class="line">user_identity =</span><br><span class="line">; 多账号区别输出</span><br><span class="line">multiple = <span class="literal">false</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>新建文件 profile&#x2F;user&#x2F;device&#x2F;device.yaml</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">device_version: 0.0.1</span><br><span class="line"></span><br><span class="line">app:</span><br><span class="line">  bili_a: <span class="comment"># Android</span></span><br><span class="line">    package: <span class="string">&quot;tv.danmaku.bili&quot;</span></span><br><span class="line">    version: <span class="string">&quot;7.58.0&quot;</span></span><br><span class="line">    build: <span class="string">&quot;7580300&quot;</span></span><br><span class="line">    channel: <span class="string">&quot;bili&quot;</span></span><br><span class="line">    device: <span class="string">&quot;phone&quot;</span></span><br><span class="line">    mobi_app: <span class="string">&quot;android&quot;</span></span><br><span class="line">    platform: <span class="string">&quot;android&quot;</span></span><br><span class="line">    s_locale: <span class="string">&quot;zh-Hans_CN&quot;</span></span><br><span class="line">    c_locale: <span class="string">&quot;zh-Hans_CH&quot;</span></span><br><span class="line">    app_key: <span class="string">&quot;MWQ4YjZlN2Q0NTIzMzQzNg==&quot;</span></span><br><span class="line">    secret_key: <span class="string">&quot;NTYwYzUyY2NkMjg4ZmVkMDQ1ODU5ZWQxOGJmZmQ5NzM&quot;</span></span><br><span class="line">    app_key_n: <span class="string">&quot;NzgzYmJiNzI2NDQ1MWQ4Mg==&quot;</span></span><br><span class="line">    secret_key_n: <span class="string">&quot;MjY1MzU4M2M4ODczZGVhMjY4YWI5Mzg2OTE4YjFkNjU=&quot;</span></span><br><span class="line">    statistics: <span class="string">&#x27;&#123;&quot;appId&quot;:1,&quot;platform&quot;:3,&quot;version&quot;:&quot;7.58.0&quot;,&quot;abtest&quot;:&quot;&quot;&#125;&#x27;</span></span><br><span class="line">  bili_i: <span class="comment"># IOS</span></span><br><span class="line">    app_key: <span class="string">&quot;MjdlYjUzZmM5MDU4ZjhjMw==&quot;</span></span><br><span class="line">    secret_key: <span class="string">&quot;YzJlZDUzYTc0ZWVlZmUzY2Y5OWZiZDAxZDhjOWMzNzU=&quot;</span></span><br><span class="line">  bili_t: <span class="comment"># Tv</span></span><br><span class="line">    app_key: <span class="string">&quot;NDQwOWUyY2U4ZmZkMTJiOA==&quot;</span></span><br><span class="line">    secret_key: <span class="string">&quot;NTliNDNlMDRhZDY5NjVmMzQzMTkwNjJiNDc4ZjgzZGQ=&quot;</span></span><br><span class="line"></span><br><span class="line">platform:</span><br><span class="line">  system:</span><br><span class="line">    os: <span class="string">&quot;android&quot;</span></span><br><span class="line">    os_ver: <span class="string">&quot;7.1.2&quot;</span></span><br><span class="line">    model: <span class="string">&quot;MuMu&quot;</span></span><br><span class="line">    network: <span class="string">&quot;2&quot;</span> <span class="comment"># 1 流量 2 WIFI</span></span><br><span class="line">  headers:</span><br><span class="line">    other_ua: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36&quot;</span></span><br><span class="line">    pc_ua: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36 Edg/95.0.1020.53Chrome/95.0.4638.69 Safari/537.36 Edg/95.0.1020.53&quot;</span></span><br><span class="line">    app_ua: <span class="string">&quot;Mozilla/5.0 BiliDroid/<span class="variable">$&#123;app.bili_a.version&#125;</span> (bbcallen@gmail.com) os/<span class="variable">$&#123;platform.system.os&#125;</span> model/<span class="variable">$&#123;device.model&#125;</span> mobi_app/<span class="variable">$&#123;app.bili_a.mobi_app&#125;</span>build/<span class="variable">$&#123;app.bili_a.build&#125;</span> channel/<span class="variable">$&#123;app.bili_a.channel&#125;</span> innerVer/<span class="variable">$&#123;app.bili_a.build&#125;</span>osVer/<span class="variable">$&#123;platform.system.os_ver&#125;</span> network/<span class="variable">$&#123;platform.system.network&#125;</span>&quot;</span></span><br></pre></td></tr></table></figure><h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --<span class="built_in">rm</span> -v /path/to/your/confFilePath:/app/profile/user lkeme/bilihelper-personal</span><br></pre></td></tr></table></figure><p>配置文件里设置好，发送完短信 </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker attach 或者docker <span class="built_in">exec</span> 再进去容器里输入</span><br></pre></td></tr></table></figure><h3 id="开启手动验证验证码"><a href="#开启手动验证验证码" class="headerlink" title="开启手动验证验证码"></a>开启手动验证验证码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[login_captcha]</span><br><span class="line">; 验证码手动识别</span><br><span class="line"><span class="built_in">enable</span> = <span class="literal">true</span></span><br><span class="line">; 验证码手动识别服务地址</span><br><span class="line">url = <span class="string">&quot;http://192.168.3.202:50001&quot;</span></span><br></pre></td></tr></table></figure><p>修改部署</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --<span class="built_in">rm</span> -e CAPTCHA=1 -e CAPTCHA_HOST=localhost -e CAPTCHA_PORT=50002 -p 50002:50002 -v /path/to/your/confFilePath:/app/profile/user lkeme/bilihelper-personal</span><br><span class="line"></span><br><span class="line">-e CAPTCHA=1 <span class="comment"># 开启验证码手动识别服务  默认 0</span></span><br><span class="line">-e CAPTCHA_HOST=0.0.0.0 <span class="comment"># 默认 0.0.0.0</span></span><br><span class="line">-e CAPTCHA_PORT=50002 <span class="comment"># 验证码手动识别服务地址  默认 50001 需要注意端口映射关系</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;命令&quot;&gt;&lt;a href=&quot;#命令&quot; class=&quot;headerlink&quot; title=&quot;命令&quot;&gt;&lt;/a&gt;命令&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;docker pull lkeme/bilihelper-personal:latest&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&quot;通过环境变量进行传入&quot;&gt;&lt;a href=&quot;#通过环境变量进行传入&quot; class=&quot;headerlink&quot; title=&quot;通过环境变量进行传入&quot;&gt;&lt;/a&gt;通过环境变量进行传入&lt;/h3&gt;</summary>
    
    
    
    <category term="docker" scheme="https://blog.48626.xyz/categories/docker/"/>
    
    
    <category term="docker" scheme="https://blog.48626.xyz/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>通过fail2ban服务监控frps日志实现禁止非法IP</title>
    <link href="https://blog.48626.xyz/da0034a8ed0b.html"/>
    <id>https://blog.48626.xyz/da0034a8ed0b.html</id>
    <published>2024-07-03T08:40:03.000Z</published>
    <updated>2024-07-03T08:40:03.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="通过fail2ban服务监控frps日志实现禁止非法IP"><a href="#通过fail2ban服务监控frps日志实现禁止非法IP" class="headerlink" title="通过fail2ban服务监控frps日志实现禁止非法IP"></a>通过fail2ban服务监控frps日志实现禁止非法IP</h2><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>服务器使用了frp作为了内网穿透软件，查看frps的日志，发现总有一些国外的ip在扫描这台服务器的端口信息，日志如下图，所以想通过fail2ban服务能够直接禁用这些ip扫描服务器。</p><p>注意一定要挂载日志文件</p><h3 id="1、安装fail2ban服务"><a href="#1、安装fail2ban服务" class="headerlink" title="1、安装fail2ban服务"></a>1、安装fail2ban服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y fail2ban</span><br></pre></td></tr></table></figure><h3 id="2、设置查找frps的规则"><a href="#2、设置查找frps的规则" class="headerlink" title="2、设置查找frps的规则"></a>2、设置查找frps的规则</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@lianhe ~]<span class="comment"># cat /etc/fail2ban/filter.d/frps.conf</span></span><br><span class="line">[Definition]</span><br><span class="line">failregex = ^.*get a user connection \[&lt;HOST&gt;:[0-9]*\]</span><br><span class="line">            ^.*get a new work connection: \[&lt;HOST&gt;:[0-9]*\]</span><br><span class="line">ignoreregex =</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用gpt4生成的规则</span></span><br><span class="line">[Definition]</span><br><span class="line">failregex = ^.*auth failed.*ip:&lt;HOST&gt;.*$</span><br><span class="line">            ^.*illegal connection.*ip:&lt;HOST&gt;.*$</span><br><span class="line">ignoreregex =</span><br></pre></td></tr></table></figure><h3 id="3、校验规则"><a href="#3、校验规则" class="headerlink" title="3、校验规则"></a>3、校验规则</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fail2ban-regex /opt/1panel/apps/frps/frps/log/frps.log /etc/fail2ban/filter.d/frps.conf</span><br></pre></td></tr></table></figure><h3 id="4、设置发现frps的异常ip的操作"><a href="#4、设置发现frps的异常ip的操作" class="headerlink" title="4、设置发现frps的异常ip的操作"></a>4、设置发现frps的异常ip的操作</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入fail2ban目录，copy一份配置文件</span></span><br><span class="line">[root@lianhe fail2ban]<span class="comment">#  cp jail.conf  jail.local</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 jail.local 下添加一下规则</span></span><br><span class="line">[frp]</span><br><span class="line">enabled = <span class="literal">true</span></span><br><span class="line">findtime = 600</span><br><span class="line">maxretry = 5</span><br><span class="line">bantime = -1</span><br><span class="line">filter = frps</span><br><span class="line">logpath = /opt/1panel/apps/frps/frps/frps.log</span><br><span class="line">protocol = all</span><br><span class="line">chain = all</span><br><span class="line">port = all</span><br><span class="line">action = iptables-allports[name=frp,protocol=tcp]</span><br></pre></td></tr></table></figure><p>配置说明<br>frp：监控目标名称<br>port：封禁全部端口<br>filter：过滤规则，我们使用自定义的frps<br>action：捕捉到恶意IP后执行的操作，本文使用iptables对IP封禁所有端口<br>logpath：需要监控的日志文件<br>bantime：封禁时间，单位为秒<br>findtime：查找时间段，单位为秒<br>maxretry：允许的最大失败次数，这里我们配置10分钟内触发10次规则，那么就封禁掉</p><h3 id="4、永久禁用ip地址"><a href="#4、永久禁用ip地址" class="headerlink" title="4、永久禁用ip地址"></a>4、永久禁用ip地址</h3><h4 id="4-1-编辑文件：-etc-fail2ban-jail-local"><a href="#4-1-编辑文件：-etc-fail2ban-jail-local" class="headerlink" title="4.1 编辑文件：&#x2F;etc&#x2F;fail2ban&#x2F;jail.local"></a>4.1 编辑文件：&#x2F;etc&#x2F;fail2ban&#x2F;jail.local</h4><p>在此件中查找banaction条目。以下屏幕截图显示禁止是iptables-multiport。</p><h4 id="4-2-编辑-banaction文件：-etc-fail2ban-action-d-iptables-multiport-conf"><a href="#4-2-编辑-banaction文件：-etc-fail2ban-action-d-iptables-multiport-conf" class="headerlink" title="4.2 编辑 banaction文件： &#x2F;etc&#x2F;fail2ban&#x2F;action.d&#x2F;iptables-multiport.conf"></a>4.2 编辑 banaction文件： &#x2F;etc&#x2F;fail2ban&#x2F;action.d&#x2F;iptables-multiport.conf</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 actionstart 默认条目下，添加以下行：</span></span><br><span class="line"><span class="built_in">cat</span> /etc/fail2ban/ip.banned | <span class="keyword">while</span> <span class="built_in">read</span> IP; <span class="keyword">do</span> iptables -I fail2ban-&lt;name&gt; 1 -s <span class="variable">$IP</span> -j DROP; <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 actionban 默认条目下，添加以下行：</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;&lt;ip&gt;&#x27;</span> &gt;&gt; /etc/fail2ban/ip.banned</span><br></pre></td></tr></table></figure><h3 id="5、fail2ban服务重新加载"><a href="#5、fail2ban服务重新加载" class="headerlink" title="5、fail2ban服务重新加载"></a>5、fail2ban服务重新加载</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fail2ban-client reload</span><br></pre></td></tr></table></figure><h3 id="6、查看frp服务器禁用那些ip"><a href="#6、查看frp服务器禁用那些ip" class="headerlink" title="6、查看frp服务器禁用那些ip"></a>6、查看frp服务器禁用那些ip</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@lianhe ~]<span class="comment"># fail2ban-client status frp</span></span><br><span class="line">Status <span class="keyword">for</span> the jail: frp</span><br><span class="line">|- Filter</span><br><span class="line">|  |- Currently failed:21</span><br><span class="line">|  |- Total failed:224</span><br><span class="line">|  `- File list:/var/lib/docker/containers/ca21dd5be6d88edad61619d3c14366dda78858ee588c751714a0facc5e2c4985/ca21dd5be6d88edad61619d3c14366dda78858ee588c751714a0facc5e2c4985-json.log</span><br><span class="line">`- Actions</span><br><span class="line">   |- Currently banned:32</span><br><span class="line">   |- Total banned:32</span><br><span class="line">   `- Banned IP list:118.113.244.254 87.120.84.35 172.104.238.212 162.215.216.231 107.173.211.107 61.140.220.92 218.19.45.23 219.152.231.118 168.76.123.59 45.183.247.34 103.164.216.221 162.241.69.208 185.137.122.180 162.62.218.43 124.152.99.57 45.88.90.55 103.154.184.109 87.107.190.12 87.107.190.59 94.156.8.86 119.28.118.4 59.13.123.99 101.126.69.60 124.156.204.21 68.66.251.162 58.210.241.5 103.78.12.14 35.200.157.232 43.153.176.71 91.92.245.192 171.106.204.37 108.179.217.143</span><br></pre></td></tr></table></figure><h3 id="7、通过iptables查看禁用ip"><a href="#7、通过iptables查看禁用ip" class="headerlink" title="7、通过iptables查看禁用ip"></a>7、通过iptables查看禁用ip</h3><h3 id="8、如果有误判的ip地址，解决方法"><a href="#8、如果有误判的ip地址，解决方法" class="headerlink" title="8、如果有误判的ip地址，解决方法"></a>8、如果有误判的ip地址，解决方法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fail2ban-client <span class="built_in">set</span>  frps  unbanip [ip地址]</span><br></pre></td></tr></table></figure><h3 id="9、重装"><a href="#9、重装" class="headerlink" title="9、重装"></a>9、重装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">service fail2ban stop</span><br><span class="line"><span class="built_in">rm</span> -r /etc/fail2ban/</span><br><span class="line">apt-get purge fail2ban</span><br><span class="line">apt-get install fail2ban</span><br></pre></td></tr></table></figure><h3 id="10、使用-Fail2ban-client-验证-Fail2ban-状态"><a href="#10、使用-Fail2ban-client-验证-Fail2ban-状态" class="headerlink" title="10、使用 Fail2ban-client 验证 Fail2ban 状态"></a>10、使用 Fail2ban-client 验证 Fail2ban 状态</h3><p>fail2ban 提供了一个命令行 fail2ban-client 用于与 Fail2ban 服务进行交互。这允许您从命令行管理和配置 Fail2ban，还允许您管理 Fail2ban 监狱。</p><p>要验证 fail2ban 安装和配置，请运行以下命令的 <em>fail2ban-client</em>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo fail2ban-client ping</span><br></pre></td></tr></table></figure><p>如果您收到诸如“服务器回复：pong”之类的输出消息，这意味着 Fail2ban 正在正常运行。</p><p>接下来，运行下面的 <em>fail2ban-client</em> 命令来检查 sshd jail 的状态。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo fail2ban-client status sshd</span><br></pre></td></tr></table></figure><p>下面你可以看到 sshd jail 的详细状态。这包括 SSH 服务的日志文件和 sshd jail 上被禁止的 IP 地址列表。</p><p>现在如果你想获得 sshd 监狱的详细配置，你可以使用 fail2ban-client 命令如下。</p><p>检查 sshd jail 的 bantime 配置。您将在几秒钟内获得 bantime 的输出。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo fail2ban-client get sshd bantime</span><br></pre></td></tr></table></figure><p>检查 sshd jail 的 maxrtey 配置。你会看到这里的 maxretry 是 3，因为它被全局配置覆盖了，也就是 maxrety 5 次。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo fail2ban-client get sshd maxretry</span><br></pre></td></tr></table></figure><p>对于sshd jail中的banaction，可以使用以下命令。并且您应该将 ufw 的输出作为 sshd jail 的默认禁令。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo fail2ban-client get sshd actions</span><br></pre></td></tr></table></figure><p>对于此处的查找时间，您还将看到 sshd 监狱的覆盖值。此处的输出也将采用秒格式。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo fail2ban-client get sshd findtime</span><br></pre></td></tr></table></figure><p>最后，您还可以使用以下命令检查 sshd jail 的默认 ignoreip。你会看到 ignoreip 与全局 Fail2ban 配置具有相同的值。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo fail2ban-client get sshd ignoreip</span><br></pre></td></tr></table></figure><h3 id="11、使用-Fail2ban-client-禁止和取消禁止-IP"><a href="#11、使用-Fail2ban-client-禁止和取消禁止-IP" class="headerlink" title="11、使用 Fail2ban-client 禁止和取消禁止 IP"></a>11、使用 Fail2ban-client 禁止和取消禁止 IP</h3><p>关于 Fail2ban 的另一个重要事项是如何在 Fail2ban 上禁止和取消禁止 IP 地址。为此，您还可以使用 fail2ban-client 命令。</p><p>要在 sshd jail 上手动禁止 IP 地址，您可以使用下面的 fail2ban-client 命令。将 IP 地址更改为您要禁止的 IP 地址。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo fail2ban-client set sshd banip IP-ADDRESS</span><br></pre></td></tr></table></figure><p>要从 sshd jail 中解禁 IP 地址，您可以使用下面的 fail2ban-client 命令。请务必将 IP 地址更改为您要取消禁止的 IP 地址。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo fail2ban-client set sshd unbanip IP-ADDRESS</span><br></pre></td></tr></table></figure><p>现在，在您手动禁止 IP 地址或取消禁止 IP 地址后，您可以使用下面的 fail2ban-client 命令进行验证。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo fail2ban-client status sshd</span><br></pre></td></tr></table></figure><p>如果您手动禁止某个 IP 地址，请确保该 IP 地址在禁止 IP 地址列表中可用。但是，如果您取消禁止某个 IP 地址，请确保该 IP 地址从禁止 IP 地址列表中消失。</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;通过fail2ban服务监控frps日志实现禁止非法IP&quot;&gt;&lt;a href=&quot;#通过fail2ban服务监控frps日志实现禁止非法IP&quot; class=&quot;headerlink&quot; title=&quot;通过fail2ban服务监控frps日志实现禁止非法IP&quot;&gt;&lt;/a&gt;通过fail2ban服务监控frps日志实现禁止非法IP&lt;/h2&gt;&lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;服务器使用了frp作为了内网穿透软件，查看frps的日志，发现总有一些国外的ip在扫描这台服务器的端口信息，日志如下图，所以想通过fail2ban服务能够直接禁用这些ip扫描服务器。&lt;/p&gt;</summary>
    
    
    
    <category term="Linux" scheme="https://blog.48626.xyz/categories/Linux/"/>
    
    <category term="fail2ban" scheme="https://blog.48626.xyz/categories/Linux/fail2ban/"/>
    
    
    <category term="Linux" scheme="https://blog.48626.xyz/tags/Linux/"/>
    
    <category term="fail2ban" scheme="https://blog.48626.xyz/tags/fail2ban/"/>
    
  </entry>
  
  <entry>
    <title>Frp穿透及防护</title>
    <link href="https://blog.48626.xyz/f2116e60767b.html"/>
    <id>https://blog.48626.xyz/f2116e60767b.html</id>
    <published>2024-07-03T08:40:03.000Z</published>
    <updated>2024-07-03T08:40:03.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-安装1Panel（非必须只需要软件frps和fail2ban，可以考虑其他安装方式）"><a href="#1-安装1Panel（非必须只需要软件frps和fail2ban，可以考虑其他安装方式）" class="headerlink" title="1. 安装1Panel（非必须只需要软件frps和fail2ban，可以考虑其他安装方式）"></a>1. 安装1Panel（非必须只需要软件frps和fail2ban，可以考虑其他安装方式）</h2><p>官网地址：<a href="https://1panel.cn/docs/installation/online_installation/">https://1panel.cn/docs/installation/online_installation/</a></p><p>根据服务器情况安装</p><p>安装过程略</p><h2 id="2-安装frps"><a href="#2-安装frps" class="headerlink" title="2. 安装frps"></a>2. 安装frps</h2><p>进入1Panel的页面</p><p>选择应用商店搜索frps</p><p>选择安装</p><p>安装后进入安装目录修改配置文件 <code>/opt/1panel/apps/frps/frps/data/frps.toml</code></p><p>根据官网（<a href="https://gofrp.org/zh-cn/docs/reference/server-configures/%EF%BC%89%E7%9A%84%E6%8F%90%E7%A4%BA%E9%85%8D%E7%BD%AE">https://gofrp.org/zh-cn/docs/reference/server-configures/）的提示配置</a></p><p>这是我使用的配置，需要把汉字部分修改为自己需要的设置</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bindAddr</span> = <span class="string">&quot;服务端监听地址，用于接收 frpc 的连接，默认监听 0.0.0.0。&quot;</span></span><br><span class="line"><span class="attr">bindPort</span> = 服务端监听端口，默认值为 <span class="number">7000</span>。</span><br><span class="line"><span class="attr">enablePrometheus</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="section">[log]</span></span><br><span class="line"><span class="attr">to</span> = <span class="string">&quot;/path/to/frps.log&quot;</span></span><br><span class="line"><span class="attr">level</span> = <span class="string">&quot;info&quot;</span></span><br><span class="line"><span class="attr">maxDays</span> = <span class="number">30</span></span><br><span class="line"></span><br><span class="line"><span class="section">[auth]</span></span><br><span class="line"><span class="attr">method</span> = <span class="string">&quot;token&quot;</span></span><br><span class="line"><span class="attr">token</span> = <span class="string">&quot;在 method 为 token 时生效，客户端需要设置一样的值才能鉴权通过。&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[webServer]</span></span><br><span class="line"><span class="attr">addr</span> = <span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line"><span class="attr">port</span> = webServer 监听端口。</span><br><span class="line"><span class="attr">user</span> = <span class="string">&quot;HTTP BasicAuth 用户名。&quot;</span></span><br><span class="line"><span class="attr">password</span> = <span class="string">&quot;HTTP BasicAuth 密码。&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="可能出现的问题"><a href="#可能出现的问题" class="headerlink" title="可能出现的问题"></a>可能出现的问题</h3><h4 id="1-docker的时间和服务器时间不同"><a href="#1-docker的时间和服务器时间不同" class="headerlink" title="1. docker的时间和服务器时间不同"></a>1. docker的时间和服务器时间不同</h4><p>点击容器</p><p>选择frps容器更多，选择编辑</p><p>在挂载中增加时间配置</p><p>在环境变量增加配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SET_CONTAINER_TIMEZONE=<span class="literal">true</span></span><br><span class="line">CONTAINER_TIMEZONE=Asia/Shanghai</span><br></pre></td></tr></table></figure><h2 id="3-安装fail2ban"><a href="#3-安装fail2ban" class="headerlink" title="3. 安装fail2ban"></a>3. 安装fail2ban</h2><p>官网提供了安装方式（<a href="https://1panel.cn/docs/user_manual/toolbox/fail2ban/%EF%BC%89">https://1panel.cn/docs/user_manual/toolbox/fail2ban/）</a></p><h3 id="添加frps规则"><a href="#添加frps规则" class="headerlink" title="添加frps规则"></a>添加frps规则</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cat /etc/fail2ban/filter.d/frps.conf</span></span><br><span class="line">[Definition]</span><br><span class="line">failregex = ^.*get a user connection \[&lt;HOST&gt;:[0-9]*\]</span><br><span class="line">            ^.*get a new work connection: \[&lt;HOST&gt;:[0-9]*\]</span><br><span class="line">ignoreregex =</span><br></pre></td></tr></table></figure><h3 id="校验规则"><a href="#校验规则" class="headerlink" title="校验规则"></a>校验规则</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fail2ban-regex /opt/1panel/apps/frps/frps/log/frps.log /etc/fail2ban/filter.d/frps.conf</span><br></pre></td></tr></table></figure><h3 id="运行规则"><a href="#运行规则" class="headerlink" title="运行规则"></a>运行规则</h3><p>在1Panel面板的工具箱中有Fail2ban的配置，点击全部配置修改，可以根据自由修改配置</p><p>frp：监控目标名称<br>port：封禁全部端口<br>filter：过滤规则，我们使用自定义的frps<br>action：捕捉到恶意IP后执行的操作，本文使用iptables对IP封禁所有端口<br>logpath：需要监控的日志文件<br>bantime：封禁时间，单位为秒<br>findtime：查找时间段，单位为秒<br>maxretry：允许的最大失败次数，这里我们配置10分钟内触发10次规则，那么就封禁掉</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#DEFAULT-START</span></span><br><span class="line">[DEFAULT]</span><br><span class="line">ignoreip = 127.0.0.1/8</span><br><span class="line">bantime = 600</span><br><span class="line">findtime = 300</span><br><span class="line">maxretry = 5</span><br><span class="line">banaction = ufw</span><br><span class="line">action = %(action_mwl)s</span><br><span class="line"><span class="comment">#DEFAULT-END</span></span><br><span class="line"></span><br><span class="line">[sshd]</span><br><span class="line">enabled = <span class="literal">true</span></span><br><span class="line">filter = sshd</span><br><span class="line">port = 22</span><br><span class="line">maxretry = 3</span><br><span class="line">findtime = 300</span><br><span class="line">bantime = 600000</span><br><span class="line">banaction = ufw</span><br><span class="line">action = %(action_mwl)s</span><br><span class="line">logpath = /var/log/auth.log</span><br><span class="line"></span><br><span class="line">[frp]</span><br><span class="line">enabled = <span class="literal">true</span></span><br><span class="line">findtime = 600</span><br><span class="line">maxretry = 5</span><br><span class="line">bantime = -1</span><br><span class="line">filter = frps</span><br><span class="line">logpath = /opt/1panel/apps/frps/frps/log/frps.log </span><br><span class="line">protocol = all</span><br><span class="line">chain = all</span><br><span class="line">port = all</span><br></pre></td></tr></table></figure><h2 id="4-安装frpc"><a href="#4-安装frpc" class="headerlink" title="4. 安装frpc"></a>4. 安装frpc</h2><p>在本地闲置电脑安装frpc，也用docker的方式</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --restart always --network host --name frpc -v /data/frpc/frpc.toml:/etc/frp/frpc.toml snowdreamtech/frpc</span><br></pre></td></tr></table></figure><p>根据官网（<a href="https://gofrp.org/zh-cn/docs/reference/client-configures/%EF%BC%89%E7%9A%84%E6%8F%90%E7%A4%BA%E9%85%8D%E7%BD%AE">https://gofrp.org/zh-cn/docs/reference/client-configures/）的提示配置</a></p><p>这是我使用的配置，需要把汉字部分修改为自己需要的设置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">user = <span class="string">&quot;LinuxDo&quot;</span></span><br><span class="line">serverAddr = <span class="string">&quot;连接服务端的地址。&quot;</span></span><br><span class="line">serverPort = 连接服务端的端口，默认为 7000。</span><br><span class="line">auth.method = <span class="string">&quot;token&quot;</span></span><br><span class="line">auth.token = <span class="string">&quot;在 method 为 token 时生效，客户端需要设置一样的值才能鉴权通过。&quot;</span></span><br><span class="line">log.to = <span class="string">&quot;console&quot;</span></span><br><span class="line">transport.tcpMux = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">[[proxies]]</span><br><span class="line">name = <span class="string">&quot;LinuxDo&quot;</span></span><br><span class="line"><span class="built_in">type</span> = <span class="string">&quot;tcp&quot;</span></span><br><span class="line">localIP = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">localPort = 8080</span><br><span class="line">remotePort = 80</span><br></pre></td></tr></table></figure><p>现在应该就能正常访问本地的服务了</p><h2 id="5-frps添加https（纯IP地址申请TLS证书，避免国内小鸡需要备份的问题）"><a href="#5-frps添加https（纯IP地址申请TLS证书，避免国内小鸡需要备份的问题）" class="headerlink" title="5. frps添加https（纯IP地址申请TLS证书，避免国内小鸡需要备份的问题）"></a>5. frps添加https（纯IP地址申请TLS证书，避免国内小鸡需要备份的问题）</h2><p>可以颁布的证书网站（<a href="https://zerossl.com/?fpr=ourlco%EF%BC%89">https://zerossl.com/?fpr=ourlco）</a></p><p>缺点：只有90天，需要手动创建，手机app使用时需要手动导入证书</p><p>下面只说明获得证书后，把ssl的三个文件放到<code>/data/frpc/data</code>文件夹下</p><p>增加frpc配置文件</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[[proxies]]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&quot;LinuxDo&quot;</span></span><br><span class="line"><span class="attr">type</span> = <span class="string">&quot;tcp&quot;</span></span><br><span class="line"><span class="attr">localIP</span> = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line"><span class="attr">localPort</span> = <span class="number">8080</span></span><br><span class="line"><span class="attr">remotePort</span> = <span class="number">81</span></span><br><span class="line"><span class="section">[proxies.plugin]</span></span><br><span class="line"><span class="attr">type</span> = <span class="string">&quot;https2http&quot;</span></span><br><span class="line"><span class="attr">localAddr</span> = <span class="string">&quot;127.0.0.1:8080&quot;</span></span><br><span class="line"><span class="attr">hostHeaderRewrite</span> = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line"><span class="attr">requestHeaders.set.x-from-where</span> = <span class="string">&quot;frp&quot;</span></span><br><span class="line"><span class="attr">crtPath</span> = <span class="string">&quot;/etc/frp/ssl/certificate.crt&quot;</span></span><br><span class="line"><span class="attr">keyPath</span> = <span class="string">&quot;/etc/frp/ssl/private.key&quot;</span></span><br></pre></td></tr></table></figure><p>重新创建frpc</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker stop frpc &amp;&amp; \</span><br><span class="line">docker <span class="built_in">rm</span> frpc &amp;&amp; \</span><br><span class="line">docker run -d --restart always --network host --name frpc -v /data/frpc/:/etc/frp/ snowdreamtech/frpc</span><br></pre></td></tr></table></figure><p>尝试过直接用cf隧道指向国内小鸡，但是fail2ban拿到的ip是小鸡ip，所以就改用了这种方式</p><h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><h3 id="frps安装"><a href="#frps安装" class="headerlink" title="frps安装"></a>frps安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name frps snowdreamtech/frps</span><br><span class="line">docker <span class="built_in">cp</span> frps:/etc/frp /data/frpc/</span><br><span class="line">docker stop frps &amp;&amp; docker <span class="built_in">rm</span> frps</span><br><span class="line">docker run -d --restart always --network host --name frps -v /data/frpc/:/etc/frp/ snowdreamtech/frps</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;1-安装1Panel（非必须只需要软件frps和fail2ban，可以考虑其他安装方式）&quot;&gt;&lt;a href=&quot;#1-安装1Panel（非必须只需要软件frps和fail2ban，可以考虑其他安装方式）&quot; class=&quot;headerlink&quot; title=&quot;1. 安装1Panel（非必须只需要软件frps和fail2ban，可以考虑其他安装方式）&quot;&gt;&lt;/a&gt;1. 安装1Panel（非必须只需要软件frps和fail2ban，可以考虑其他安装方式）&lt;/h2&gt;&lt;p&gt;官网地址：&lt;a href=&quot;https://1panel.cn/docs/installation/online_installation/&quot;&gt;https://1panel.cn/docs/installation/online_installation/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;根据服务器情况安装&lt;/p&gt;</summary>
    
    
    
    <category term="Linux" scheme="https://blog.48626.xyz/categories/Linux/"/>
    
    <category term="Frp" scheme="https://blog.48626.xyz/categories/Linux/Frp/"/>
    
    
    <category term="Linux" scheme="https://blog.48626.xyz/tags/Linux/"/>
    
    <category term="Frp" scheme="https://blog.48626.xyz/tags/Frp/"/>
    
  </entry>
  
  <entry>
    <title>对Hexo博客静态资源进行压缩</title>
    <link href="https://blog.48626.xyz/be35e2ef1345.html"/>
    <id>https://blog.48626.xyz/be35e2ef1345.html</id>
    <published>2024-07-02T03:02:30.000Z</published>
    <updated>2024-07-02T03:02:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>注意包的版本，这里只展示glup4</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">npm install @babel/core@^7.24.7 \</span><br><span class="line">            @babel/preset-env@^7.24.7 \</span><br><span class="line">            gulp-babel@^8.0.0 \</span><br><span class="line">            gulp-cache@^1.1.3 \</span><br><span class="line">            gulp-clean-css@^4.3.0 \</span><br><span class="line">            gulp-htmlclean@^2.7.22 \</span><br><span class="line">            gulp-htmlmin@^5.0.1 \</span><br><span class="line">            gulp-imagemin@^6.2.0 \</span><br><span class="line">            gulp-minify-css@^1.2.4 \</span><br><span class="line">            gulp-uglify@^3.0.2 \</span><br><span class="line">            imagemin-pngquant@^10.0.0 \</span><br><span class="line">            gulp@4.0.2</span><br></pre></td></tr></table></figure><h2 id="创建-gulpfile-js"><a href="#创建-gulpfile-js" class="headerlink" title="创建 gulpfile.js"></a>创建 gulpfile.js</h2><p>在 <code>Hexo</code> 博客的根目录下面，创建一个 <code>gulpfile.js</code> 文件，这个名字不可改，必须是这个名字。<br>在刚创建的文件中写入如下代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">&#x27;gulp&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> minifycss = <span class="built_in">require</span>(<span class="string">&#x27;gulp-minify-css&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> uglify = <span class="built_in">require</span>(<span class="string">&#x27;gulp-uglify&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> htmlmin = <span class="built_in">require</span>(<span class="string">&#x27;gulp-htmlmin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> htmlclean = <span class="built_in">require</span>(<span class="string">&#x27;gulp-htmlclean&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> babel = <span class="built_in">require</span>(<span class="string">&#x27;gulp-babel&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> cache = <span class="built_in">require</span>(<span class="string">&#x27;gulp-cache&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> imagemin = <span class="built_in">require</span>(<span class="string">&#x27;gulp-imagemin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 压缩css文件</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;minify-css&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;./public/**/*.css&#x27;</span>)</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">minifycss</span>())</span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;./public&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 压缩js文件，支持将ES6代码转换成ES5代码</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;minify-js&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;./public/**/*.js&#x27;</span>)</span><br><span class="line">      .<span class="title function_">pipe</span>(<span class="title function_">babel</span>(&#123;</span><br><span class="line">        <span class="attr">presets</span>: [<span class="string">&#x27;@babel/preset-env&#x27;</span>]</span><br><span class="line">      &#125;))</span><br><span class="line">      .<span class="title function_">pipe</span>(<span class="title function_">uglify</span>())</span><br><span class="line">      .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;./public&#x27;</span>));</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 压缩html文件</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;minify-html&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;./public/**/*.html&#x27;</span>)</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">htmlclean</span>())</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">htmlmin</span>(&#123;</span><br><span class="line">      <span class="attr">removeComments</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">minifyJS</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">minifyCSS</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">minifyURLs</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;))</span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;./public&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getPngquant</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable language_">module</span> = <span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">&#x27;imagemin-pngquant&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">module</span>.<span class="property">default</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">// 压缩图片(深度压缩)</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;minify-images&#x27;</span>, <span class="keyword">async</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> pngquant = <span class="keyword">await</span> <span class="title function_">getPngquant</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;./public/**/*.&#123;png,jpg,gif,ico&#125;&#x27;</span>)</span><br><span class="line">      .<span class="title function_">pipe</span>(<span class="title function_">cache</span>(<span class="title function_">imagemin</span>(&#123;                   <span class="comment">// 启用缓存，只压缩发生变化的图片</span></span><br><span class="line">        <span class="attr">progressive</span>: <span class="literal">true</span>,                     <span class="comment">// 是否无损压缩 jpg 图片</span></span><br><span class="line">        <span class="attr">interlaced</span>: <span class="literal">false</span>,                     <span class="comment">// 是否隔行扫描 gif 进行渲染</span></span><br><span class="line">        <span class="attr">svgoPlugins</span>: [&#123;<span class="attr">removeViewBox</span>: <span class="literal">false</span>&#125;], <span class="comment">// 是否移除 svg 的 viewbox 属性</span></span><br><span class="line">        <span class="attr">multipass</span>: <span class="literal">false</span>,                      <span class="comment">// 是否多次优化 svg 直到完全优化</span></span><br><span class="line">        <span class="attr">optimizationLevel</span>: <span class="number">5</span>,                  <span class="comment">// 优化等级，取值范围：0-7，默认值：3</span></span><br><span class="line">        <span class="attr">use</span>: [<span class="title function_">pngquant</span>()]                      <span class="comment">// 使用 pngquant 深度压缩 png 图片的 imagemin 插件</span></span><br><span class="line">      &#125;)))</span><br><span class="line">      .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;./public&#x27;</span>));</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// gulp4的写法</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;default&#x27;</span>,gulp.<span class="title function_">series</span>(gulp.<span class="title function_">parallel</span>(<span class="string">&#x27;minify-css&#x27;</span>, <span class="string">&#x27;minify-js&#x27;</span>,<span class="string">&#x27;minify-html&#x27;</span>, <span class="string">&#x27;minify-images&#x27;</span>,<span class="keyword">function</span>(<span class="params">done</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Gulp is running!&#x27;</span>);</span><br><span class="line">    <span class="title function_">done</span>();</span><br><span class="line">  &#125;)));</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>注意:</p><ul><li>以上代码是运行在 <code>gulp4</code> 环境的，与 <code>gulp3</code> 不通用</li><li>图片压缩速度很慢，若不需要压缩图片，请将第52行的代码中的 <code>&#39;minify-img&#39;</code> 删除，忽略其它文件压缩同理。</li></ul><h2 id="对代码进行压缩"><a href="#对代码进行压缩" class="headerlink" title="对代码进行压缩"></a>对代码进行压缩</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">gulp build</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>先清空文件，生成静态文件，然后使用 <code>gulp</code> 命令对代码进行压缩，最后将其推送到服务器就行了</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;注意包的版本，这里只展示glup4&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;npm install @babel/core@^7.24.7 &#92;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            @babel/preset-env@^7.24.7 &#92;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            gulp-babel@^8.0.0 &#92;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            gulp-cache@^1.1.3 &#92;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            gulp-clean-css@^4.3.0 &#92;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            gulp-htmlclean@^2.7.22 &#92;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            gulp-htmlmin@^5.0.1 &#92;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            gulp-imagemin@^6.2.0 &#92;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            gulp-minify-css@^1.2.4 &#92;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            gulp-uglify@^3.0.2 &#92;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            imagemin-pngquant@^10.0.0 &#92;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            gulp@4.0.2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&quot;创建-gulpfile-js&quot;&gt;&lt;a href=&quot;#创建-gulpfile-js&quot; class=&quot;headerlink&quot; title=&quot;创建 gulpfile.js&quot;&gt;&lt;/a&gt;创建 gulpfile.js&lt;/h2&gt;</summary>
    
    
    
    <category term="Hexo" scheme="https://blog.48626.xyz/categories/Hexo/"/>
    
    
    <category term="Hexo" scheme="https://blog.48626.xyz/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>docker安装mysql</title>
    <link href="https://blog.48626.xyz/2d010ac21d89.html"/>
    <id>https://blog.48626.xyz/2d010ac21d89.html</id>
    <published>2024-07-02T02:58:06.000Z</published>
    <updated>2024-07-02T02:58:06.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="mysql5"><a href="#mysql5" class="headerlink" title="mysql5"></a>mysql5</h2><h3 id="下载镜像"><a href="#下载镜像" class="headerlink" title="下载镜像"></a>下载镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql:5.7.37</span><br></pre></td></tr></table></figure><h3 id="在home目录下创建映射目录"><a href="#在home目录下创建映射目录" class="headerlink" title="在home目录下创建映射目录"></a>在home目录下创建映射目录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p ~/mysql5/&#123;conf.d,logs,data&#125;</span><br></pre></td></tr></table></figure><h3 id="创建my-cnf配置文件"><a href="#创建my-cnf配置文件" class="headerlink" title="创建my.cnf配置文件"></a>创建my.cnf配置文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/mysql5/conf.d/my.cnf</span><br></pre></td></tr></table></figure><h4 id="my-cnf"><a href="#my-cnf" class="headerlink" title="my.cnf"></a>my.cnf</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">user=mysql</span><br><span class="line">init_connect=<span class="string">&#x27;SET collation_connection = utf8mb4_unicode_ci&#x27;</span></span><br><span class="line">init_connect=<span class="string">&#x27;SET NAMES utf8mb4&#x27;</span></span><br><span class="line">character-set-server=utf8mb4</span><br><span class="line">collation-server=utf8_unicode_ci</span><br><span class="line">default_authentication_plugin=mysql_native_password</span><br><span class="line">secure_file_priv=/var/lib/mysql</span><br><span class="line">expire_logs_days=7</span><br><span class="line">sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION</span><br><span class="line">max_connections=1000</span><br><span class="line">default-time_zone=<span class="string">&#x27;+8:00&#x27;</span></span><br><span class="line"></span><br><span class="line">[client]</span><br><span class="line">default-character-set=utf8mb4</span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line">default-character-set=utf8mb4</span><br></pre></td></tr></table></figure><h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><p>MySQL(5.7.19)的默认配置文件是 &#x2F;etc&#x2F;mysql&#x2F;my.cnf 文件。</p><p>如果想要自定义配置，建议向 &#x2F;etc&#x2F;mysql&#x2F;conf.d 目录中创建 .cnf 文件。</p><p>新建的文件可以任意起名，只要保证后缀名是 cnf 即可。</p><p>新建的文件中的配置项可以覆盖 &#x2F;etc&#x2F;mysql&#x2F;my.cnf 中的配置项。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name mysql5 -v ~/mysql5/conf:/etc/mysql/conf.d -v ~/mysql5/logs:/logs -v ~/mysql5/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -dit -p 3306:3306 mysql:5.7.37</span><br></pre></td></tr></table></figure><h3 id="远程登录"><a href="#远程登录" class="headerlink" title="远程登录"></a>远程登录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#进入容器5</span></span><br><span class="line">docker <span class="built_in">exec</span> -it mysql5 /bin/bash</span><br><span class="line"><span class="comment">#登录mysql</span></span><br><span class="line">mysql -u root -p</span><br><span class="line"><span class="comment"># 查看数据库</span></span><br><span class="line">show databases;</span><br><span class="line"><span class="keyword">select</span> host, user,plugin,authentication_string from mysql.user;</span><br><span class="line"><span class="comment"># 更新 root的 远程登录为所有</span></span><br><span class="line">update mysql.user <span class="built_in">set</span> host=<span class="string">&#x27;%&#x27;</span> <span class="built_in">where</span> user=<span class="string">&#x27;root&#x27;</span>; </span><br><span class="line"><span class="keyword">select</span> host, user,plugin,authentication_string from mysql.user;</span><br><span class="line"> <span class="comment"># 给用户授权</span></span><br><span class="line">grant all privileges on *.* to root@<span class="string">&#x27;%&#x27;</span> identified by <span class="string">&#x27;123456&#x27;</span>; </span><br><span class="line"><span class="comment"># 刷新权限</span></span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><h2 id="mysql8"><a href="#mysql8" class="headerlink" title="mysql8"></a>mysql8</h2><h3 id="下载镜像-1"><a href="#下载镜像-1" class="headerlink" title="下载镜像"></a>下载镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql:8</span><br></pre></td></tr></table></figure><h3 id="在home目录下创建映射目录-1"><a href="#在home目录下创建映射目录-1" class="headerlink" title="在home目录下创建映射目录"></a>在home目录下创建映射目录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p ~/mysql8/&#123;conf.d,logs,data&#125;</span><br></pre></td></tr></table></figure><h3 id="创建my-cnf配置文件-1"><a href="#创建my-cnf配置文件-1" class="headerlink" title="创建my.cnf配置文件"></a>创建my.cnf配置文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/mysql8/conf.d/my.cnf</span><br></pre></td></tr></table></figure><h4 id="my-cnf-1"><a href="#my-cnf-1" class="headerlink" title="my.cnf"></a>my.cnf</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">user=mysql</span><br><span class="line">init_connect=<span class="string">&#x27;SET collation_connection = utf8mb4_unicode_ci&#x27;</span></span><br><span class="line">init_connect=<span class="string">&#x27;SET NAMES utf8mb4&#x27;</span></span><br><span class="line">character-set-server=utf8mb4</span><br><span class="line">collation-server=utf8_unicode_ci</span><br><span class="line">default_authentication_plugin=mysql_native_password</span><br><span class="line">secure_file_priv=/var/lib/mysql</span><br><span class="line">expire_logs_days=7</span><br><span class="line">sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION</span><br><span class="line">max_connections=1000</span><br><span class="line">default-time_zone=<span class="string">&#x27;+8:00&#x27;</span></span><br><span class="line"></span><br><span class="line">[client]</span><br><span class="line">default-character-set=utf8mb4</span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line">default-character-set=utf8mb4</span><br></pre></td></tr></table></figure><h3 id="运行-1"><a href="#运行-1" class="headerlink" title="运行"></a>运行</h3><p>如果想要自定义配置，建议向 &#x2F;etc&#x2F;mysql&#x2F;conf.d 目录中创建 .cnf 文件。</p><p>新建的文件可以任意起名，只要保证后缀名是 cnf 即可。</p><p>新建的文件中的配置项可以覆盖 &#x2F;etc&#x2F;mysql&#x2F;my.cnf 中的配置项。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name mysql8 -v ~/mysql8/conf:/etc/mysql/conf.d -v ~/mysql8/logs:/logs -v ~/mysql8/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=Abcd1234! -dit -p 3306:3306 mysql:8</span><br></pre></td></tr></table></figure><h3 id="远程登录-1"><a href="#远程登录-1" class="headerlink" title="远程登录"></a>远程登录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#进入容器8</span></span><br><span class="line">docker <span class="built_in">exec</span> -it mysql8 /bin/bash</span><br><span class="line"><span class="comment">#登录mysql</span></span><br><span class="line">mysql -u root -p</span><br><span class="line">use mysql;</span><br><span class="line"><span class="keyword">select</span> host,user from user;</span><br><span class="line">ALTER USER <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED BY <span class="string">&#x27;Abcd1234!&#x27;</span>;</span><br><span class="line">flush privileges;</span><br><span class="line"><span class="comment">#添加远程登录用户</span></span><br><span class="line">CREATE USER <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED WITH mysql_native_password BY <span class="string">&#x27;Abcd1234!&#x27;</span>;</span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;mysql5&quot;&gt;&lt;a href=&quot;#mysql5&quot; class=&quot;headerlink&quot; title=&quot;mysql5&quot;&gt;&lt;/a&gt;mysql5&lt;/h2&gt;&lt;h3 id=&quot;下载镜像&quot;&gt;&lt;a href=&quot;#下载镜像&quot; class=&quot;headerlink&quot; title=&quot;下载镜像&quot;&gt;&lt;/a&gt;下载镜像&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;docker pull mysql:5.7.37&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="docker" scheme="https://blog.48626.xyz/categories/docker/"/>
    
    <category term="mysql" scheme="https://blog.48626.xyz/categories/docker/mysql/"/>
    
    
    <category term="docker" scheme="https://blog.48626.xyz/tags/docker/"/>
    
    <category term="mysql" scheme="https://blog.48626.xyz/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>mysql主从设置</title>
    <link href="https://blog.48626.xyz/967f626b21b0.html"/>
    <id>https://blog.48626.xyz/967f626b21b0.html</id>
    <published>2024-07-01T02:58:06.000Z</published>
    <updated>2024-07-01T02:58:06.000Z</updated>
    
    <content type="html"><![CDATA[<p>什么是主从，详细百度去吧，我说说我自己的理解</p><ul><li><p>为了灾备</p></li><li><p>均衡负载，提高吞吐量</p></li></ul><h2 id="主备的原理"><a href="#主备的原理" class="headerlink" title="主备的原理"></a>主备的原理</h2><p>主服务器（master） 把数据同步到从服务器（slave）</p><img src="/967f626b21b0/1.jpg" class=""><h2 id="下面就是实现了"><a href="#下面就是实现了" class="headerlink" title="下面就是实现了"></a>下面就是实现了</h2><p>首先需要两个mysql（本地测试推荐：phpstudy里面复制两个mysql）</p><h3 id="修改my-ini"><a href="#修改my-ini" class="headerlink" title="修改my.ini"></a>修改my.ini</h3><p>— 唯一 ,要与备机的不同</p><p><code>server_id = 101</code></p><p>— 开启二进制日志</p><p><code>log-bin= mysql-bin</code></p><h3 id="设置服务"><a href="#设置服务" class="headerlink" title="设置服务"></a>设置服务</h3><p>— 设置服务</p><p><code>.\mysqld.exe install MySQL-3310 –defaults-file=”D:\PhpStudy\MySQL\my.ini”</code></p><p>— 删除服务</p><p><code>.\mysqld.exe remove MySQL-3310</code></p><p>— 开启服务</p><p><code>net start MySQL-3310</code></p><h3 id="远程连接"><a href="#远程连接" class="headerlink" title="远程连接"></a>远程连接</h3><p>— 查询连接账户</p><p><code>SELECT USER,HOST from user;</code></p><p>— 开启远程</p><p><code>grant all privileges on . to ‘root’@’%’ identified by ‘root’ with grant option;</code></p><h3 id="创建连接用户（主机配置）"><a href="#创建连接用户（主机配置）" class="headerlink" title="创建连接用户（主机配置）"></a>创建连接用户（主机配置）</h3><p>— CREATE USER ‘使用名’@’备机IP地址’ IDENTIFIED BY ‘密码’;#创建用户</p><p><code>create user ‘usermysql’@’localhost’ identified by ‘123456’;</code></p><p>— GRANT REPLICATION SLAVE ON . TO ‘使用名’@’备机IP地址’;#分配权限</p><p><code>grant replication slave on . to ‘usermysql’@’localhost’;</code></p><p>— 刷新权限</p><p><code>flush privileges;</code></p><p>— 查看master状态</p><p><code>show master status;</code></p><p>创建连接（从机配置）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">CHANGE MASTER TO </span><br><span class="line">MASTER_HOST=’localhost’, #主机的IP</span><br><span class="line">MASTER_PORT=3306,</span><br><span class="line">MASTER_USER=’usermysql’, #之前创建的那个使用名</span><br><span class="line">MASTER_PASSWORD=’123456′, #密码</span><br><span class="line">MASTER_LOG_FILE=’mysql-bin.000001′, #这是主库中show master status;File下的那个值</span><br><span class="line">MASTER_LOG_POS=446;#这是主库Position下的那个值</span><br><span class="line"></span><br><span class="line">Slave_IO_Running: Yes</span><br><span class="line">Slave_SQL_Running: Yes </span><br><span class="line">看到这两个都是Yes就成了</span><br></pre></td></tr></table></figure><p>— 关闭</p><p><code>stop slave;</code></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;什么是主从，详细百度去吧，我说说我自己的理解&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;为了灾备&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;均衡负载，提高吞吐量&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;主备的原理&quot;&gt;&lt;a href=&quot;#主备的原理&quot; class=&quot;headerlink&quot; title=&quot;主备的原理&quot;&gt;&lt;/a&gt;主备的原理&lt;/h2&gt;</summary>
    
    
    
    <category term="mysql" scheme="https://blog.48626.xyz/categories/mysql/"/>
    
    
    <category term="mysql" scheme="https://blog.48626.xyz/tags/mysql/"/>
    
  </entry>
  
</feed>
